import{j as a}from"./jsx-runtime-f961835c.js";import{r as d}from"./index-f80c8c95.js";import{m as T}from"./classUtils-ef6e60eb.js";import{u as te,a as re,b as P,n as ne}from"./_useMobileMenuToggling-15a67498.js";import"./getSVGtext-8f35f9ab.js";import{g as le}from"./i18n-18e56484.js";import{C as se}from"./Checkbox-b2f212c8.js";import{F as oe}from"./FocusTrap-56c2452f.js";import{F as ie,a as ue}from"./FormField-532841a0.js";import{T as ce}from"./TagPill-1903d380.js";import"./_Link-b7c9c4c9.js";import{H as de}from"./HiddenTiger-e2ccf9ec.js";import{f as pe}from"./knobs-e5289b83.js";import"./_TogglerInput-331f3df2.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./_Button-0c36286c.js";import"./cssutils-e70a1e0e.js";import"./assets-b24d1fcc.js";import"./themes-56ee0168.js";const me=1e4,fe=100,he=1,ge=1/10,be=e=>10/(10+e),A=(e,o)=>{let p=0;return o.forEach(u=>{e.split(/\s+/).forEach((s,c)=>{let r=0;if(s===u)r+=me;else{const m=s.indexOf(u);m===0?r+=fe:m>0&&(r+=he)}p+=r*be(c)})}),p},ye=(e,o,p,u)=>{if(!e.value)return 0;const s=e.value.toLowerCase().trim(),c=(u==null?void 0:u.toLowerCase().trim())||s;let r=A(c,o);return r||(r=ge*A(s,o)),r},ve="🍌",Se=(e,o,p=ye,u=s=>s.label)=>{if(!o.trim())return e;const s=new Set,c=o.toLowerCase().trim().split(/\s+/);return e.map(r=>({item:r,score:p(r,c,o,u(r))})).filter(({score:r})=>r>0).sort((r,m)=>r.score===m.score?0:r.score<m.score?1:-1).map(({item:r})=>r).filter(r=>{const m=r.value+ve+r.label;return s.has(m)?!1:(s.add(m),!0)})},xe=(e,o)=>{const p=Array.isArray(e)?e:[e],u=d.useMemo(()=>p,p);d.useEffect(()=>{const s=c=>{!u.some(m=>{const f=m.current;return f?f.contains(c.target):!1})&&o(c)};return document.addEventListener("mousedown",s),document.addEventListener("touchstart",s),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[o,u])},U={searchableLimit:20,summaryLimit:20},{searchableLimit:we,summaryLimit:Ve}=U,_e={pl:{search:"Wyszukaj opcje",buttonShow:"Pokaż opcje",currentValues:"Wybrane wartości",noneFoundMsg:"Brak dopasowań"},en:{search:"Search options",buttonShow:"Show options",currentValues:"Currently selected",noneFoundMsg:"No matches"},is:{search:"Leita í valkostum",buttonShow:"Birta valkosti",currentValues:"Valin gildi",noneFoundMsg:"Ekkert passar"}},L=e=>{const{onSelected:o,options:p,disabled:u,readOnly:s}=e,c=u===!0,r=!c&&u,m=te(e.name),[f,N]=re(e,"value",[]),R=f.length>0,K=!R&&!e.placeholder,O=f.length?void 0:e.placeholder,M=le(e,_e),_=d.useRef(null),V=d.useRef(null),[S,q]=d.useState(-1),[j,I]=d.useState(""),[b,$]=d.useState(!1),x=t=>{$(n=>(t=typeof t=="boolean"?t:!n,t||(V.current.querySelector(".Multiselect__choices").scrollTo(0,0),I(""),q(-1)),t))};xe(V,()=>x(!1));const w=d.useMemo(()=>p.map(t=>typeof t=="string"?{value:t}:t),[p]),J=e.forceSearchable||w.length>=we,B=f.length>0&&(e.forceSummary||!b||w.length>=Ve),y=d.useMemo(()=>Se(w,j,e.searchScoring,e.getSearchContent),[j,w,e.searchScoring,e.getSearchContent]),Q=w!==y,k=d.useCallback(t=>{const n=t.value,h=f.indexOf(n)===-1,i=h?[...f,n]:f.filter(l=>l!==n),v=[...new Set(w.filter(l=>i.includes(l.value)).map(l=>l.value))];N(v),o&&o({value:t.value,checked:h,option:t,selectedValues:v})},[f,w,o,N]),X=t=>{const n=t.target.value;I(n===" "?"":n),x(!0)},Y=t=>{j.length===0&&[" ","Delete","Backspace"].includes(t.key)&&x(S>-1?!0:!b)};return d.useEffect(()=>{if(!b)return;const t=n=>{const h=_.current;if(n.key==="ArrowUp")n.preventDefault(),h.focus(),q(i=>i===0?y.length-1:i-1);else if(n.key==="ArrowDown")n.preventDefault(),h.focus(),q(i=>i===y.length-1?0:i+1);else if(n.key==="Escape")n.preventDefault(),h.blur(),h.focus(),x(!1);else if(n.key==="Enter"||n.key===" "){if(n.target.closest(".Multiselect__currentvalues"))return;if(S>=0&&S<y.length){n.preventDefault();const v=y[S];v&&k(v)}}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[S,y,b,k,_]),d.useEffect(()=>{const t=V.current;if(!t)return;let n;const h=()=>clearTimeout(n),i=()=>{n=setTimeout(()=>x(!1),200)};return t.addEventListener("focusin",h),t.addEventListener("focusout",i),()=>{t.removeEventListener("focusin",h),t.removeEventListener("focusout",i)}},[]),d.useEffect(()=>{var t,n;(n=(t=V.current)==null?void 0:t.querySelectorAll(".Multiselect__option")[S])==null||n.scrollIntoView({behavior:"smooth",block:"nearest"})},[S]),a.jsx(ie,{extraClassName:T("Multiselect",e.nowrap&&"nowrap"),group:"inputlike",filled:R,empty:K,...ue(e),renderInput:(t,n,h,i)=>{const{id:v}=n;return a.jsxs("div",{className:T("Multiselect__input",[b&&"open"],t.input),...h(),"data-sprinkled":i,ref:V,children:[i?J?a.jsx("input",{className:"Multiselect__search",id:`toggler:${v}`,"aria-label":M.search,"aria-controls":P(),"data-expanded":b||void 0,onChange:X,onKeyDown:Y,onClick:()=>x(),value:j,placeholder:O,disabled:c,ref:_}):a.jsx("button",{className:"Multiselect__toggler",id:`toggler:${v}`,type:"button","aria-label":M.buttonShow,"aria-controls":P(),"aria-expanded":b,onClick:()=>x(),disabled:c,ref:_,children:O||" "}):null,a.jsxs("div",{className:"Multiselect__choices",tabIndex:-1,children:[i&&B&&a.jsx("div",{className:"Multiselect__currentvalues",onClick:b||c?void 0:()=>{var l;x(),(l=_.current)==null||l.focus()},"aria-label":`${M.currentValues}:`,children:f.map(l=>w.find(g=>g.value===l)).filter(ne).map((l,g)=>a.jsx(ce,{large:!0,label:l.label||l.value,...b&&!s?{removable:!0,onRemove:()=>{k(l),V.current.querySelector(".Multiselect__choices").focus()}}:{removable:!1}},g))}),a.jsxs("ul",{id:v,className:"Multiselect__options","aria-expanded":i?b:void 0,hidden:i&&!b,role:"group","aria-labelledby":n["aria-labelledby"],"aria-describedby":n["aria-describedby"],"aria-required":e.required,children:[y.length?y.map((l,g)=>{const Z=l.disabled!=null?l.disabled:r&&r.includes(g),ee=f.includes(l.value),ae=!Q&&l.group!==(y[g-1]||{}).group&&(g>0||!!l.group),D=a.jsx(se,{className:T("Multiselect__option",S===g&&"focused"),reqText:!1,disabled:Z,readOnly:s,required:e.required,Wrapper:"li",name:m,...l,checked:ee,"aria-invalid":e.invalid,label:l.label||l.value,onChange:()=>k(l),onFocus:()=>q(g),wrapperProps:{onMouseEnter:()=>q(g)}},g);return ae?a.jsxs(d.Fragment,{children:[a.jsx("li",{className:T("Multiselect__optionSeparator",!l.group&&"empty"),"aria-label":l.group?void 0:"—",children:l.group||!1}),D]},g):D}):j?a.jsx("li",{className:"Multiselect__noresults",children:M.noneFoundMsg}):void 0,i&&a.jsx(oe,{Tag:"li"})]})]})]})}})};L.meta=U;try{L.displayName="Multiselect",L.__docgenInfo={description:"",displayName:"Multiselect",props:{className:{defaultValue:null,description:'Container className - alongside "FormField"',name:"className",required:!1,type:{name:"string"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:"SSRSupport"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},LabelTag:{defaultValue:null,description:"",name:"LabelTag",required:!1,type:{name:"enum",value:[{value:'"h3"'},{value:'"h4"'},{value:'"h5"'}]}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[] | TogglerGroupOptions<string, { group?: string | undefined; }>"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean | readonly number[]"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"RestrictedInputProps"}},onSelected:{defaultValue:null,description:"",name:"onSelected",required:!1,type:{name:"((payload: { value: string; checked: boolean; option: TogglerGroupOption<string, { group?: string; }>; selectedValues: string[]; }) => void)"}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:'boolean | "true" | "false"'}},"aria-labelledby":{defaultValue:null,description:"",name:"aria-labelledby",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}},nowrap:{defaultValue:null,description:`Prevent the selected items from wrapping into multiple lines.
Use this option when vertical space is limited.`,name:"nowrap",required:!1,type:{name:"boolean"}},searchScoring:{defaultValue:null,description:`Custom function to calculate a search score for a given option item.
Higher scores mean better matches.

A score of zero (or less) means the item is not a valid match.`,name:"searchScoring",required:!1,type:{name:"SearchScoringfn"}},getSearchContent:{defaultValue:null,description:"Custom function to extract the searchable content from a given option item.\nBy default, the `label` property is used.",name:"getSearchContent",required:!1,type:{name:"((item: TogglerGroupOption<string, { group?: string; }>) => string)"}},forceSummary:{defaultValue:null,description:`Force display the current values at the top of the dropdown,
even when the total options are fewer than
\`Multiselect.meta.summaryLimit\`.

NOTE: Using this option is generally not recommended,
because the search UI (i.e. the on-screen keyboard), takes up a lot of
space on mobile devices.`,name:"forceSummary",required:!1,type:{name:"boolean"}},forceSearchable:{defaultValue:null,description:`Force the options to be searchable, even when they're
fewer than \`Multiselect.meta.searchableLimit\`.

NOTE: Using this option is generally not recommended,
because the summary takes up valuable space when there are only a few
items.`,name:"forceSearchable",required:!1,type:{name:"boolean"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"MultiselectI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}}}}}catch{}const F=pe({hideLabel:!1}),Ke={title:"Forms/Multiselect",parameters:{viewport:{defaultViewport:"responsive"}}},E=["Chocolate","Strawberry","Vanilla","Coffee","Mint Chocolate Chip","Rocky Road","Cookies and Cream","Butter Pecan","Pistachio","Maple Walnut","Caramel","Fudge"],z=[{value:"Vanilla",group:"Favourites"},{value:"Pistachio",group:"Favourites"},{value:"Maple Walnut",group:"Favourites"}];z.push(...E.map(e=>({value:e})));const qe=e=>{const{nowrap:o,empty:p,grouped:u,forceSearchable:s,forceSummary:c}=e,r=F.getProps(e),m=p?[]:o?E:E.slice(2,4),f=[o,p,s,c,JSON.stringify(r)].join("-");return a.jsxs(d.Fragment,{children:[a.jsx(L,{nowrap:o,...r,label:"Veldu tegund",name:"flavours",options:u?z:E,value:m,forceSearchable:s,forceSummary:c}),a.jsxs(de,{children:[a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{})]})]},f)},C={render:e=>a.jsx(qe,{...e}),argTypes:{nowrap:{name:"No-wrap"},empty:{name:"Empty"},grouped:{name:"Grouped items"},forceSearchable:{name:"Searchable options"},forceSummary:{name:"Summarize selected values",if:{arg:"empty",truthy:!1}},...F.argTypes},args:{nowrap:!1,empty:!1,grouped:!1,forceSearchable:!1,forceSummary:!1,...F.args}};var W,H,G;C.parameters={...C.parameters,docs:{...(W=C.parameters)==null?void 0:W.docs,source:{originalSource:`{
  render: args => <MultiselectStory {...args} />,
  argTypes: {
    nowrap: {
      name: 'No-wrap'
    },
    empty: {
      name: 'Empty'
    },
    grouped: {
      name: 'Grouped items'
    },
    forceSearchable: {
      name: 'Searchable options'
    },
    forceSummary: {
      name: 'Summarize selected values',
      if: {
        arg: 'empty',
        truthy: false
      }
    },
    ...ffCtrls.argTypes
  },
  args: {
    nowrap: false,
    empty: false,
    grouped: false,
    forceSearchable: false,
    forceSummary: false,
    ...ffCtrls.args
  }
}`,...(G=(H=C.parameters)==null?void 0:H.docs)==null?void 0:G.source}}};const $e=["_Multiselect"];export{C as _Multiselect,$e as __namedExportsOrder,Ke as default};
//# sourceMappingURL=Multiselect.stories-9cb5fe31.js.map
