import{j as k}from"./jsx-runtime-f961835c.js";import{r as N,g as K}from"./index-f80c8c95.js";import{t as Q,g as X,a as Z}from"./getBemClass-701a9212.js";import{d as ee}from"./domid-a414b1fb.js";import{g as te,F as ne}from"./FormField-700213a7.js";var W={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var n=N,c=ee;function o(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var y=o(c),s=n.useId,g=s?function(t){var l=s();return t||l}:function(t){return n.useRef(t||y.default()).current},u=function(t){return n.useEffect(t,[])},V=function(t){var l=n.useRef(t);l.current=t,n.useEffect(function(){return function(){return l.current()}},[])},f=function(t,l){var d=n.useRef(!1),b=n.useRef(t);b.current=t,n.useEffect(function(){if(d.current)return b.current();d.current=!0},l)},C=function(t){return n.useRef(t).current},_=function(t){var l=n.useRef(t),d=!!t;l.current=t,n.useEffect(function(){if(d){var b=function(R){R.key==="Escape"&&l.current&&l.current()};return document.addEventListener("keydown",b),function(){document.removeEventListener("keydown",b)}}},[d])},E=function(t,l){return l===void 0&&(l="topContent"),u(function(){return document.documentElement.dataset[l]=t,function(){delete document.documentElement.dataset[l]}})},O=!0;e.DEFAULT_SSR_SUPPORT=O;var S=function(t,l,d){d===void 0&&(d=e.DEFAULT_SSR_SUPPORT);var b=n.useState(d?t:l);return u(function(){d===!0&&b[1](l)}),b},q=function(t){return S(!0,!1,t)[0]||void 0},i=function(t){return S(!1,!0,t)[0]||void 0},m=[],h=function(t){e.DEFAULT_SSR_SUPPORT=t??O,m.unshift(e.DEFAULT_SSR_SUPPORT)};h.pop=function(){m.shift(),e.DEFAULT_SSR_SUPPORT=m[0]!=null?m[0]:O},e.setDefaultSSR=h,e.useCallbackOnEsc=_,e.useClientState=S,e.useConst=C,e.useDomid=g,e.useIsBrowserSide=i,e.useIsServerSide=q,e.useNotifyTopContent=E,e.useOnMount=u,e.useOnUnmount=V,e.useOnUpdate=f})(W);var L=Q,p=N,re=X,j=Z,ae=W,le=function(e,n){if(n!=null){var c=String(n);return e.find(function(o){return String(typeof o=="object"?o.value:o)===c})}},G=function(e){return e.label!=null?e.label:String(e.value)},ue="     ",ie=function(e,n,c,o){var y,s=(n==null||n==="")&&c!=null?!1:(y=le(e,n))!==null&&y!==void 0?y:c==null&&e[0],g;if(s!==!1&&s!=null){var u=typeof s=="object"?G(s):String(s);u=u.trimRight(),g=o&&u?o(s):u}return(g??c)||ue},se=function(e,n,c){if(e)return n!=null?String(n):c!=null?String(c):!0},oe={opacity:1e-4,position:"absolute",bottom:0,left:0,width:"100%",height:"100%",top:"auto",right:"auto",margin:0,padding:0,border:0},de=function(e){var n=p.useState(!1),c=n[0],o=n[1],y=p.useRef(null),s=e.className,g=e.bem,u=g===void 0?"Selectbox":g,V=e.modifier,f=e.value,C=e.defaultValue,_=e.options,E=e.visibleFormat,O=e.ssr,S=e.onSelected,q=e.onChange,i=e.placeholder,m=e.readOnly,h=e.selectRef,t=h===void 0?y:h,l=L.__rest(e,["className","bem","modifier","value","defaultValue","options","visibleFormat","ssr","onSelected","onChange","placeholder","readOnly","selectRef"]),d=ae.useIsBrowserSide(O),b=p.useState(function(){return f??C}),R=b[0],T=b[1],w=se(m,f,R),M=p.useMemo(function(){var r=_.map(function(v){return typeof v=="string"||typeof v=="number"?{value:v}:L.__assign({},v)});if(w!=null){var a=!1,x=typeof w=="string"?w:r[0].value;r.forEach(function(v){if(String(v.value)===x&&!a){a=!0;return}v.disabled=!0})}var J=r.reduce(function(v,F,ve){if(!F.group)return v.push(F),v;var D=v[v.length-1],U=D&&"title"in D?D:void 0;return U&&U.title===F.group?U.options.push(F):v.push({title:F.group,options:[F]}),v},[]);return{optionsNorm:r,groupedOptions:J}},[_,w]),P=M.optionsNorm,Y=M.groupedOptions,$=p.useMemo(function(){return ie(_,R,i,E)},[R,_,i,E]),I=i!=null;p.useEffect(function(){var r,a;if(f==null){t.current&&T(t.current.value);return}if(f===""&&I){T("");return}if(P.find(function(x){return x.value===f})){T(f);return}if(I){T("");return}T((a=(r=P[0])===null||r===void 0?void 0:r.value)!==null&&a!==void 0?a:"")},[f,P,I]);var z=d?void 0:u?j(u,V,s):s,A=function(r,a){return p.createElement("option",{key:a,value:r.value!=null?r.value:"",disabled:r.disabled},G(r).trimRight())},B=p.createElement("select",L.__assign({ref:t,className:z},l,{onFocus:function(r){var a;(a=e.onFocus)===null||a===void 0||a.call(e,r),o(!0)},onBlur:function(r){var a;(a=e.onBlur)===null||a===void 0||a.call(e,r),o(!1)},value:R,style:d&&oe,"data-fancy":d&&"",onChange:function(r){var a=r.currentTarget.selectedIndex-(i!=null?1:0);T(P[a].value),q&&q(r),S&&S(P[a].value,_[a])}}),i!=null&&p.createElement("option",{value:"",disabled:e.placeholderDisabled},i),Y.map(function(r,a){return"title"in r?p.createElement("optgroup",{label:r.title,key:a},r.options.map(A)):A(r,a)}));return d?p.createElement("span",{className:j(u,V,s)+re(u,[c&&"focused",e.disabled&&"disabled"]),style:{position:"relative"}},p.createElement("span",{className:j(u+"__value",!R&&R!==0&&"empty")},$),B):B},ce=de;const fe=K(ce),me=e=>{const n=typeof e=="object"?e.value:e;return typeof n=="number"?String(n):n},H=e=>{const{onChange:n,fieldWrapperProps:c,...o}=te(e),{value:y,defaultValue:s,placeholder:g,options:u}=o,V=N.useRef(null),f=o.selectRef||V,C=()=>y??s??me(u[0]),[_,E]=N.useState(()=>!!C()),[O,S]=N.useState(()=>!C()&&!g);N.useEffect(()=>{setTimeout(()=>{var m;const i=f.current;i&&(E(!!i.value),S(!((m=i.selectedOptions[0])!=null&&m.text)))},0)},[f,y,s,u]);const q=i=>{var h;const m=i.currentTarget;E(!!m.value),S(!((h=m.selectedOptions[0])!=null&&h.text)),n&&n(i)};return k.jsx(ne,{extraClassName:"Selectbox",empty:O,filled:_,...c,renderInput:(i,m,h)=>k.jsx(fe,{bem:i.input,ssr:e.ssr,onChange:q,...m,...h(o),selectRef:f})})};try{H.displayName="Selectbox",H.__docgenInfo={description:"",displayName:"Selectbox",props:{className:{defaultValue:null,description:`Container className - alongside "FormField"
Class-name for the <span> wrapper around the <select>`,name:"className",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Disables all options except the currently selected one.",name:"readOnly",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:'boolean | "ssr-only"'}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string | number"}},placeholder:{defaultValue:null,description:`Generates a <option value="" /> at the start of the select's option list`,name:"placeholder",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | number"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"readonly O[]"}},placeholderDisabled:{defaultValue:null,description:"",name:"placeholderDisabled",required:!1,type:{name:"boolean"}},onSelected:{defaultValue:null,description:"Sugar alternative to `onChange`.\n\nIf placeholder option was selected, then `value === undefined`",name:"onSelected",required:!1,type:{name:'((value: O extends SelectboxOption<string | number> ? O["value"] : O, option: O) => void)'}},visibleFormat:{defaultValue:null,description:`Custom visual label formatter.

NOTE: The formatter is only called for non-empty labels
in order to make a \`<Selectbox/>\`'s "visibly empty" status more predictably
inferrable by reading \`selectRef.current?.selectedOptions[0].textContent\``,name:"visibleFormat",required:!1,type:{name:"((selected: O) => NonNullable<ReactNode>)"}},selectRef:{defaultValue:null,description:"Ref object that points to the native <select/> element",name:"selectRef",required:!1,type:{name:"RefObject<HTMLSelectElement>"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}}}}}catch{}export{H as S};
//# sourceMappingURL=Selectbox-168b2516.js.map
