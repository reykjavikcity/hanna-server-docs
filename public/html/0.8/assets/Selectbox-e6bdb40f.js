import{j as H}from"./jsx-runtime-f961835c.js";import{g as J,r as x}from"./index-f80c8c95.js";import{t as K,g as Q,a as X}from"./getBemClass-701a9212.js";import{h as Z}from"./hooks-d45327d9.js";import{g as ee,F as te}from"./FormField-eaf65ac7.js";var M=K,c=x,le=Q,P=X,ne=Z,ae=function(e,n){if(n!=null){var u=String(n);return e.find(function(s){return String(typeof s=="object"?s.value:s)===u})}},W=function(e){return e.label!=null?e.label:String(e.value)},re="     ",se=function(e,n,u,s){var m,i=(n==null||n==="")&&u!=null?!1:(m=ae(e,n))!==null&&m!==void 0?m:u==null&&e[0],p;if(i!==!1&&i!=null){var o=typeof i=="object"?W(i):String(i);o=o.trimRight(),p=s&&o?s(i):o}return(p??u)||re},ie=function(e,n,u){if(e)return n!=null?String(n):u!=null?String(u):!0},oe={opacity:1e-4,position:"absolute",bottom:0,left:0,width:"100%",height:"100%",top:"auto",right:"auto",margin:0,padding:0,border:0},ue=function(e){var n=c.useState(!1),u=n[0],s=n[1],m=c.useRef(null),i=e.className,p=e.bem,o=p===void 0?"Selectbox":p,q=e.modifier,d=e.value,O=e.defaultValue,v=e.options,_=e.visibleFormat,C=e.ssr,V=e.onSelected,E=e.onChange,a=e.placeholder,f=e.readOnly,b=e.selectRef,F=b===void 0?m:b,G=M.__rest(e,["className","bem","modifier","value","defaultValue","options","visibleFormat","ssr","onSelected","onChange","placeholder","readOnly","selectRef"]),R=ne.useIsBrowserSide(C),L=c.useState(function(){return d??O}),g=L[0],y=L[1],N=ie(f,d,g),k=c.useMemo(function(){var t=v.map(function(r){return typeof r=="string"||typeof r=="number"?{value:r}:M.__assign({},r)});if(N!=null){var l=!1,T=typeof N=="string"?N:t[0].value;t.forEach(function(r){if(String(r.value)===T&&!l){l=!0;return}r.disabled=!0})}var z=t.reduce(function(r,h,me){if(!h.group)return r.push(h),r;var I=r[r.length-1],j=I&&"title"in I?I:void 0;return j&&j.title===h.group?j.options.push(h):r.push({title:h.group,options:[h]}),r},[]);return{optionsNorm:t,groupedOptions:z}},[v,N]),S=k.optionsNorm,U=k.groupedOptions,Y=c.useMemo(function(){return se(v,g,a,_)},[g,v,a,_]),w=a!=null;c.useEffect(function(){var t,l;if(d==null){F.current&&y(F.current.value);return}if(d===""&&w){y("");return}if(S.find(function(T){return T.value===d})){y(d);return}if(w){y("");return}y((l=(t=S[0])===null||t===void 0?void 0:t.value)!==null&&l!==void 0?l:"")},[d,S,w]);var $=R?void 0:o?P(o,q,i):i,B=function(t,l){return c.createElement("option",{key:l,value:t.value!=null?t.value:"",disabled:t.disabled},W(t).trimRight())},D=c.createElement("select",M.__assign({ref:F,className:$},G,{onFocus:function(t){var l;(l=e.onFocus)===null||l===void 0||l.call(e,t),s(!0)},onBlur:function(t){var l;(l=e.onBlur)===null||l===void 0||l.call(e,t),s(!1)},value:g,style:R&&oe,"data-fancy":R&&"",onChange:function(t){var l=t.currentTarget.selectedIndex-(a!=null?1:0);y(S[l].value),E&&E(t),V&&V(S[l].value,v[l])}}),a!=null&&c.createElement("option",{value:"",disabled:e.placeholderDisabled},a),U.map(function(t,l){return"title"in t?c.createElement("optgroup",{label:t.title,key:l},t.options.map(B)):B(t,l)}));return R?c.createElement("span",{className:P(o,q,i)+le(o,[u&&"focused",e.disabled&&"disabled"]),style:{position:"relative"}},c.createElement("span",{className:P(o+"__value",!g&&g!==0&&"empty")},Y),D):D},de=ue;const ce=J(de),fe=e=>{const n=typeof e=="object"?e.value:e;return typeof n=="number"?String(n):n},A=e=>{const{onChange:n,fieldWrapperProps:u,...s}=ee(e),{value:m,defaultValue:i,placeholder:p,options:o}=s,q=x.useRef(null),d=s.selectRef||q,O=()=>m??i??fe(o[0]),[v,_]=x.useState(()=>!!O()),[C,V]=x.useState(()=>!O()&&!p);x.useEffect(()=>{setTimeout(()=>{var f;const a=d.current;a&&(_(!!a.value),V(!((f=a.selectedOptions[0])!=null&&f.text)))},0)},[d,m,i,o]);const E=a=>{var b;const f=a.currentTarget;_(!!f.value),V(!((b=f.selectedOptions[0])!=null&&b.text)),n&&n(a)};return H.jsx(te,{extraClassName:"Selectbox",empty:C,filled:v,...u,renderInput:(a,f,b)=>H.jsx(ce,{bem:a.input,ssr:e.ssr,onChange:E,...f,...b(s),selectRef:d})})};try{A.displayName="Selectbox",A.__docgenInfo={description:"",displayName:"Selectbox",props:{className:{defaultValue:null,description:`Container className - alongside "FormField"
Class-name for the <span> wrapper around the <select>`,name:"className",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Disables all options except the currently selected one.",name:"readOnly",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:'boolean | "ssr-only"'}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string | number"}},placeholder:{defaultValue:null,description:`Generates a <option value="" /> at the start of the select's option list`,name:"placeholder",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | number"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"readonly O[]"}},placeholderDisabled:{defaultValue:null,description:"",name:"placeholderDisabled",required:!1,type:{name:"boolean"}},onSelected:{defaultValue:null,description:"Sugar alternative to `onChange`.\n\nIf placeholder option was selected, then `value === undefined`",name:"onSelected",required:!1,type:{name:'((value: O extends SelectboxOption<string | number> ? O["value"] : O, option: O) => void)'}},visibleFormat:{defaultValue:null,description:`Custom visual label formatter.

NOTE: The formatter is only called for non-empty labels
in order to make a \`<Selectbox/>\`'s "visibly empty" status more predictably
inferrable by reading \`selectRef.current?.selectedOptions[0].textContent\``,name:"visibleFormat",required:!1,type:{name:"((selected: O) => NonNullable<ReactNode>)"}},selectRef:{defaultValue:null,description:"Ref object that points to the native <select/> element",name:"selectRef",required:!1,type:{name:"RefObject<HTMLSelectElement>"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}}}}}catch{}export{A as S};
//# sourceMappingURL=Selectbox-e6bdb40f.js.map
