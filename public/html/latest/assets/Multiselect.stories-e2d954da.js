import{j as a}from"./jsx-runtime-f961835c.js";import{r as p}from"./index-f80c8c95.js";import{m as C}from"./getSVGtext-a8bc7f1c.js";import{u as ae,a as te,n as re}from"./_useMobileMenuToggling-7bb485b9.js";import{g as ne}from"./i18n-d547729d.js";import{u as le}from"./useOnClickOutside-2e1471b7.js";import{C as se}from"./Checkbox-5bb7d141.js";import{F as oe}from"./FocusTrap-e81f6d3e.js";import{F as ie,a as ue}from"./FormField-40abbd78.js";import{T as ce}from"./TagPill-3ac20044.js";import"./_Link-b7c9c4c9.js";import{H as de}from"./HiddenTiger-e2ccf9ec.js";import{f as pe}from"./knobs-64c2f928.js";import"./_TogglerInput-66f6c90c.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./_Button-3c35395f.js";import"./cssutils-e70a1e0e.js";import"./assets-b24d1fcc.js";import"./themes-56ee0168.js";const me=1e4,fe=100,he=1,ge=1/10,be=e=>10/(10+e),P=(e,o)=>{let h=0;return o.forEach(u=>{e.split(/\s+/).forEach((i,c)=>{let n=0;if(i===u)n+=me;else{const m=i.indexOf(u);m===0?n+=fe:m>0&&(n+=he)}h+=n*be(c)})}),h},ye=(e,o,h,u)=>{if(!e.value)return 0;const i=e.value.toLowerCase().trim(),c=(u==null?void 0:u.toLowerCase().trim())||i;let n=P(c,o);return n||(n=ge*P(i,o)),n},ve="🍌",Se=(e,o,h=ye,u=i=>i.label)=>{if(!o.trim())return e;const i=new Set,c=o.toLowerCase().trim().split(/\s+/);return e.map(n=>({item:n,score:h(n,c,o,u(n))})).filter(({score:n})=>n>0).sort((n,m)=>n.score===m.score?0:n.score<m.score?1:-1).map(({item:n})=>n).filter(n=>{const m=n.value+ve+n.label;return i.has(m)?!1:(i.add(m),!0)})},H={searchableLimit:20,summaryLimit:20},{searchableLimit:xe,summaryLimit:Ve}=H,we={pl:{search:"Wyszukaj opcje",buttonShow:"Pokaż opcje",currentValues:"Wybrane wartości",noneFoundMsg:"Brak dopasowań"},en:{search:"Search options",buttonShow:"Show options",currentValues:"Currently selected",noneFoundMsg:"No matches"},is:{search:"Leita í valkostum",buttonShow:"Birta valkosti",currentValues:"Valin gildi",noneFoundMsg:"Ekkert passar"}},F=e=>{const{onSelected:o,options:h,disabled:u,readOnly:i}=e,c=u===!0,n=!c&&u,m=ae(e.name),[g,L]=te(e,"value",[]),R=g.length>0,z=!R&&!e.placeholder,O=g.length?void 0:e.placeholder,k=ne(e,we),_=p.useRef(null),w=p.useRef(null),[S,q]=p.useState(-1),[j,I]=p.useState(""),[b,K]=p.useState(!1),x=t=>{K(r=>(t=typeof t=="boolean"?t:!r,t||(w.current.querySelector(".Multiselect__choices").scrollTo(0,0),I(""),q(-1)),t))};le(w,()=>x(!1));const V=p.useMemo(()=>h.map(t=>typeof t=="string"?{value:t}:t),[h]),$=e.forceSearchable||V.length>=xe,J=g.length>0&&(e.forceSummary||!b||V.length>=Ve),v=p.useMemo(()=>Se(V,j,e.searchScoring,e.getSearchContent),[j,V,e.searchScoring,e.getSearchContent]),B=V!==v,M=p.useCallback(t=>{const r=t.value,d=g.indexOf(r)===-1,s=d?[...g,r]:g.filter(l=>l!==r),y=[...new Set(V.filter(l=>s.includes(l.value)).map(l=>l.value))];L(y),o&&o({value:t.value,checked:d,option:t,selectedValues:y})},[g,V,o,L]),Q=t=>{const r=t.target.value;I(r===" "?"":r),x(!0)},X=t=>{j.length===0&&[" ","Delete","Backspace"].includes(t.key)&&x(S>-1?!0:!b)};return p.useEffect(()=>{if(!b)return;const t=r=>{const d=_.current;if(r.key==="ArrowUp")r.preventDefault(),d.focus(),q(s=>s===0?v.length-1:s-1);else if(r.key==="ArrowDown")r.preventDefault(),d.focus(),q(s=>s===v.length-1?0:s+1);else if(r.key==="Escape")r.preventDefault(),d.blur(),d.focus(),x(!1);else if(r.key==="Enter"||r.key===" "){if(r.target.closest(".Multiselect__currentvalues"))return;if(S>=0&&S<v.length){r.preventDefault();const y=v[S];y&&M(y)}}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[S,v,b,M,_]),p.useEffect(()=>{const t=w.current;if(!t)return;let r;const d=()=>clearTimeout(r),s=()=>{r=setTimeout(()=>x(!1),200)};return t.addEventListener("focusin",d),t.addEventListener("focusout",s),()=>{t.removeEventListener("focusin",d),t.removeEventListener("focusout",s)}},[]),p.useEffect(()=>{var t,r;(r=(t=w.current)==null?void 0:t.querySelectorAll(".Multiselect__option")[S])==null||r.scrollIntoView({behavior:"smooth",block:"nearest"})},[S]),a.jsx(ie,{extraClassName:C("Multiselect",e.nowrap&&"nowrap"),group:"inputlike",filled:R,empty:z,...ue(e),renderInput:(t,r,d,s)=>{const{id:y}=r;return a.jsxs("div",{className:C("Multiselect__input",[b&&"open"],t.input),...d(),"data-sprinkled":s,ref:w,children:[s?$?a.jsx("input",{className:"Multiselect__search",id:`toggler:${y}`,"aria-label":k.search,"aria-controls":y,"data-expanded":b||void 0,onChange:Q,onKeyDown:X,onClick:()=>x(),value:j,placeholder:O,disabled:c,ref:_}):a.jsx("button",{className:"Multiselect__toggler",id:`toggler:${y}`,type:"button","aria-label":k.buttonShow,"aria-controls":y,"aria-expanded":b,onClick:()=>x(),disabled:c,ref:_,children:O||" "}):null,a.jsxs("div",{className:"Multiselect__choices",tabIndex:-1,children:[s&&J&&a.jsx("div",{className:"Multiselect__currentvalues",onClick:b||c?void 0:()=>{var l;x(),(l=_.current)==null||l.focus()},"aria-label":`${k.currentValues}:`,children:g.map(l=>V.find(f=>f.value===l)).filter(re).map((l,f)=>a.jsx(ce,{large:!0,label:l.label||l.value,...b&&!i?{removable:!0,onRemove:()=>{M(l),w.current.querySelector(".Multiselect__choices").focus()}}:{removable:!1}},f))}),a.jsxs("ul",{id:y,className:"Multiselect__options","aria-expanded":s?b:void 0,hidden:s&&!b,role:"group","aria-labelledby":r["aria-labelledby"],"aria-describedby":r["aria-describedby"],"aria-required":e.required,children:[v.length?v.map((l,f)=>{const Y=l.disabled!=null?l.disabled:n&&n.includes(f),Z=g.includes(l.value),ee=!B&&l.group!==(v[f-1]||{}).group&&(f>0||!!l.group),D=a.jsx(se,{className:C("Multiselect__option",S===f&&"focused"),reqText:!1,disabled:Y,readOnly:i,required:e.required,Wrapper:"li",name:m,...l,checked:Z,"aria-invalid":e.invalid,label:l.label||l.value,onChange:()=>M(l),onFocus:()=>q(f),wrapperProps:{onMouseEnter:()=>q(f)}},f);return ee?a.jsxs(p.Fragment,{children:[a.jsx("li",{className:C("Multiselect__optionSeparator",!l.group&&"empty"),"aria-label":l.group?void 0:"—",children:l.group||!1}),D]},f):D}):j?a.jsx("li",{className:"Multiselect__noresults",children:k.noneFoundMsg}):void 0,s&&a.jsx(oe,{Tag:"li"})]})]})]})}})};F.meta=H;try{F.displayName="Multiselect",F.__docgenInfo={description:"",displayName:"Multiselect",props:{className:{defaultValue:null,description:'Container className - alongside "FormField"',name:"className",required:!1,type:{name:"string"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:"SSRSupport"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},LabelTag:{defaultValue:null,description:"",name:"LabelTag",required:!1,type:{name:"enum",value:[{value:'"h3"'},{value:'"h4"'},{value:'"h5"'}]}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[] | TogglerGroupOptions<string, { group?: string | undefined; }>"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean | readonly number[]"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"RestrictedInputProps"}},onSelected:{defaultValue:null,description:"",name:"onSelected",required:!1,type:{name:"((payload: { value: string; checked: boolean; option: TogglerGroupOption<string, { group?: string; }>; selectedValues: string[]; }) => void)"}},renderItemSubContent:{defaultValue:null,description:`Render function that allows inserting content below each toggler
(checkbox/radio) element, depending on the item's checked status
(or other external state)`,name:"renderItemSubContent",required:!1,type:{name:"((option: TogglerGroupOption<string, { group?: string; }>, checked: boolean) => ReactNode)"}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:'boolean | "true" | "false"'}},"aria-labelledby":{defaultValue:null,description:"",name:"aria-labelledby",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}},nowrap:{defaultValue:null,description:`Prevent the selected items from wrapping into multiple lines.
Use this option when vertical space is limited.`,name:"nowrap",required:!1,type:{name:"boolean"}},searchScoring:{defaultValue:null,description:`Custom function to calculate a search score for a given option item.
Higher scores mean better matches.

A score of zero (or less) means the item is not a valid match.`,name:"searchScoring",required:!1,type:{name:"SearchScoringfn"}},getSearchContent:{defaultValue:null,description:"Custom function to extract the searchable content from a given option item.\nBy default, the `label` property is used.",name:"getSearchContent",required:!1,type:{name:"((item: TogglerGroupOption<string, { group?: string; }>) => string)"}},forceSummary:{defaultValue:null,description:`Force display the current values at the top of the dropdown,
even when the total options are fewer than
\`Multiselect.meta.summaryLimit\`.

NOTE: Using this option is generally not recommended,
because the search UI (i.e. the on-screen keyboard), takes up a lot of
space on mobile devices.`,name:"forceSummary",required:!1,type:{name:"boolean"}},forceSearchable:{defaultValue:null,description:`Force the options to be searchable, even when they're
fewer than \`Multiselect.meta.searchableLimit\`.

NOTE: Using this option is generally not recommended,
because the summary takes up valuable space when there are only a few
items.`,name:"forceSearchable",required:!1,type:{name:"boolean"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"MultiselectI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}}}}}catch{}const N=pe({hideLabel:!1}),ze={title:"Forms/Multiselect",parameters:{viewport:{defaultViewport:"responsive"}}},E=["Chocolate","Strawberry","Vanilla","Coffee","Mint Chocolate Chip","Rocky Road","Cookies and Cream","Butter Pecan","Pistachio","Maple Walnut","Caramel","Fudge"],U=[{value:"Vanilla",group:"Favourites"},{value:"Pistachio",group:"Favourites"},{value:"Maple Walnut",group:"Favourites"}];U.push(...E.map(e=>({value:e})));const _e=e=>{const{nowrap:o,empty:h,grouped:u,forceSearchable:i,forceSummary:c}=e,n=N.getProps(e),m=h?[]:o?E:E.slice(2,4),g=[o,h,i,c,JSON.stringify(n)].join("-");return a.jsxs(p.Fragment,{children:[a.jsx(F,{nowrap:o,...n,label:"Veldu tegund",name:"flavours",options:u?U:E,value:m,forceSearchable:i,forceSummary:c}),a.jsxs(de,{children:[a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{})]})]},g)},T={render:e=>a.jsx(_e,{...e}),argTypes:{nowrap:{name:"No-wrap"},empty:{name:"Empty"},grouped:{name:"Grouped items"},forceSearchable:{name:"Searchable options"},forceSummary:{name:"Summarize selected values",if:{arg:"empty",truthy:!1}},...N.argTypes},args:{nowrap:!1,empty:!1,grouped:!1,forceSearchable:!1,forceSummary:!1,...N.args}};var W,A,G;T.parameters={...T.parameters,docs:{...(W=T.parameters)==null?void 0:W.docs,source:{originalSource:`{
  render: args => <MultiselectStory {...args} />,
  argTypes: {
    nowrap: {
      name: 'No-wrap'
    },
    empty: {
      name: 'Empty'
    },
    grouped: {
      name: 'Grouped items'
    },
    forceSearchable: {
      name: 'Searchable options'
    },
    forceSummary: {
      name: 'Summarize selected values',
      if: {
        arg: 'empty',
        truthy: false
      }
    },
    ...ffCtrls.argTypes
  },
  args: {
    nowrap: false,
    empty: false,
    grouped: false,
    forceSearchable: false,
    forceSummary: false,
    ...ffCtrls.args
  }
}`,...(G=(A=T.parameters)==null?void 0:A.docs)==null?void 0:G.source}}};const Ke=["_Multiselect"];export{T as _Multiselect,Ke as __namedExportsOrder,ze as default};
//# sourceMappingURL=Multiselect.stories-e2d954da.js.map
