import{j as o}from"./jsx-runtime-f961835c.js";import{r as A}from"./range-dbab87d5.js";import{r as h}from"./index-f80c8c95.js";import{m as z}from"./classUtils-ef6e60eb.js";import{g as C}from"./i18n-18e56484.js";import{I as D}from"./_Image-73a64cfc.js";import{L as H}from"./_Link-b7c9c4c9.js";import{u as P}from"./getScrollbarWidth-70c1e033.js";import{A as $}from"./Alert-e278cf16.js";import{T as U}from"./Tabs-56931aa7.js";import{g as Q}from"./assets-ca39b462.js";import"./useGetSVGtext-c22e972a.js";import"./getSVGtext-8f35f9ab.js";import"./_Button-f001a419.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./getPageScrollElm-bb23cb91.js";var b=new Map,_=new WeakMap,w=0,G=void 0;function W(e){return e?(_.has(e)||(w+=1,_.set(e,w.toString())),_.get(e)):"0"}function Z(e){return Object.keys(e).sort().filter(function(r){return e[r]!==void 0}).map(function(r){return r+"_"+(r==="root"?W(e.root):e[r])}).toString()}function B(e){var r=Z(e),a=b.get(r);if(!a){var t=new Map,s,u=new IntersectionObserver(function(d){d.forEach(function(i){var l,n=i.isIntersecting&&s.some(function(c){return i.intersectionRatio>=c});e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=n),(l=t.get(i.target))==null||l.forEach(function(c){c(n,i)})})},e);s=u.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),a={id:r,observer:u,elements:t},b.set(r,a)}return a}function J(e,r,a,t){if(a===void 0&&(a={}),t===void 0&&(t=G),typeof window.IntersectionObserver>"u"&&t!==void 0){var s=e.getBoundingClientRect();return r(t,{isIntersecting:t,target:e,intersectionRatio:typeof a.threshold=="number"?a.threshold:0,time:0,boundingClientRect:s,intersectionRect:s,rootBounds:s}),function(){}}var u=B(a),d=u.id,i=u.observer,l=u.elements,n=l.get(e)||[];return l.has(e)||l.set(e,n),n.push(r),i.observe(e),function(){n.splice(n.indexOf(r),1),n.length===0&&(l.delete(e),i.unobserve(e)),l.size===0&&(i.disconnect(),b.delete(d))}}function K(e){var r=e===void 0?{}:e,a=r.threshold,t=r.delay,s=r.trackVisibility,u=r.rootMargin,d=r.root,i=r.triggerOnce,l=r.skip,n=r.initialInView,c=r.fallbackInView,m=h.useRef(),p=h.useState({inView:!!n}),g=p[0],y=p[1],v=h.useCallback(function(k){m.current!==void 0&&(m.current(),m.current=void 0),!l&&k&&(m.current=J(k,function(E,N){y({inView:E,entry:N}),N.isIntersecting&&i&&m.current&&(m.current(),m.current=void 0)},{root:d,rootMargin:u,threshold:a,trackVisibility:s,delay:t},c))},[Array.isArray(a)?a.toString():a,d,u,i,l,s,c,t]);h.useEffect(function(){!m.current&&g.entry&&!i&&!l&&y({inView:!!n})});var f=[v,g.inView,g.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}var L={};Object.defineProperty(L,"__esModule",{value:!0});var X=function(e){var r=typeof e!="number"?parseFloat(""+e):e;if(isNaN(r)){typeof process!==void 0&&console.error("prettyNum can't format:",e);return}return r},R={is:[",","."]};R.testing=R.is;var M=[],Y=function(e,r){r===void 0&&(r={});var a=r.decimals,t=a===void 0?0:a,s=r.fixedDecimals,u=r.leadingZero,d=u===void 0?!0:u,i=r.lang,l=i===void 0?"en":i,n=X(e);if(n==null)return"";if(!r.splitters&&Intl.Collator.supportedLocalesOf(l).length===1){var c=n.toLocaleString(l,{maximumFractionDigits:t,minimumFractionDigits:t});return t>0&&!s&&n===Math.round(n)&&(c=c.replace(/\D0+$/,"")),!d&&Math.abs(n)<1&&(c=c.replace(/^(-?)0/,"$1")),c}var m=r.splitters||R[l]||[],p=m[0]||".",g=m[1]||"",y=M[t]||(M[t]=new RegExp("\\.\\d{".concat(t,"}"))),v=(s||y.test(String(n))?n.toFixed(t):String(n)).split("."),f=v[0].replace(/\d(?=(\d{3})+$)/g,"$&"+g);return f=!d&&f[0]==="0"?f.replace(/\d/,""):f,f+(v[1]?p+v[1]:"")},I=L.prettyNum=Y;const S=e=>{const{highlight:r,title:a,summary:t,href:s,meta:u,image:d}=e,i=r?"SearchResultsHighlightItem":"SearchResultsItem",l=Array.isArray(u)?u:[u];return o.jsx("li",{className:i,children:o.jsxs(H,{className:i+"__link",href:s,children:[o.jsx("h3",{className:i+"__title",children:a}),l.length>0&&o.jsx("span",{className:i+"__meta",children:l.map((n,c)=>typeof n=="function"?n():n&&o.jsx("span",{children:n},c))}),r&&d&&o.jsx(D,{bem:i+"__image",src:d}),o.jsx("div",{className:i+"__summary",dangerouslySetInnerHTML:{__html:t}})]})})};try{S.displayName="SearchResultsItem",S.__docgenInfo={description:"",displayName:"SearchResultsItem",props:{title:{defaultValue:null,description:"Plain text title",name:"title",required:!0,type:{name:"string"}},summary:{defaultValue:null,description:"Simple HTML-encoded summary (excluding any layout)",name:"summary",required:!0,type:{name:"string"}},href:{defaultValue:null,description:"",name:"href",required:!0,type:{name:"string"}},meta:{defaultValue:null,description:"",name:"meta",required:!1,type:{name:"MetaValue | readonly MetaValue[]"}},image:{defaultValue:null,description:`URL to the image to display with the result item.
Should ideally be approximately 600-700px wide`,name:"image",required:!1,type:{name:"string"}},highlight:{defaultValue:null,description:'Should this search-result item be displayed as a "major"/"main" result at the top',name:"highlight",required:!1,type:{name:"boolean"}}}}}catch{}const ee=()=>o.jsxs(o.Fragment,{children:["Úps, það hefur komið upp villa. Má bjóða þér að prófa aftur að leita?",o.jsx("br",{}),"Ef ekkert lát er á villunni þá kunnum við að meta að þú látir okkur vita."]}),re={en:{lang:"en",loadQueryTitle:"Loading results...",resultsTitle:"results found for",noResultsTitle:"No results were found for",loadMore:"Load more"},is:{lang:"is",loadQueryTitle:"Sæki niðurstöður...",resultsTitle:"leitarniðurstöður fyrir",noResultsTitle:"Engar leitarniðurstöður fundust fyrir",loadMore:"Sækja fleiri"},pl:{lang:"pl",loadQueryTitle:"Ładowanie wyników...",resultsTitle:"wyniki wyszukiwania dla",noResultsTitle:"Nie znaleziono wyników dla",loadMore:"Załaduj więcej"}},te=e=>{const{domid:r,filters:a,activeIdx:t,setFilter:s,lang:u}=e,d=h.useMemo(()=>(a||[]).map(({label:i,count:l})=>({label:i,badge:I(l,{lang:u})})),[a,u]);return d.length?o.jsx(U,{role:"tablist","aria-controls":r,tabs:d,activeIdx:t||0,onSetActive:i=>s&&s(i)}):null},O=e=>e.count?o.jsx("ol",{className:"SearchResults__list SearchResults__list--loading",children:A(1,e.count).map((r,a)=>o.jsx(S,{title:"...",summary:"",href:""},a))}):null,ae=2,se=e=>{const{status:r,hits:a,numItems:t,loadMore:s,pageSize:u,texts:d}=e,{lang:i}=d,l=(a||0)-(t||0),n=h.useRef(0),c=!s||n.current>=ae,[m,p]=K({rootMargin:"150px 0px 0px 0px",skip:c});return h.useEffect(()=>{p&&s&&(n.current=n.current+1,s())},[p,s]),r==="loadingmore"?o.jsx(O,{count:Math.min(u,l)}):r==="results"&&l&&s?o.jsxs("button",{ref:m,className:"SearchResults__loadmore",type:"button",onClick:s,children:[d.loadMore," ",o.jsxs("span",{className:"SearchResults__loadmore__count",children:["(",I(l,{lang:i}),")"]})]}):null},ie=(e,r)=>{const{status:a,totalHits:t,query:s}=e;return o.jsxs("h2",{className:"SearchResults__title",children:[a==="loadingquery"?r.loadQueryTitle:t?I(t,{lang:r.lang})+" "+r.resultsTitle:r.noResultsTitle,o.jsx("span",{className:"SearchResults__query",children:s})]})},ne=e=>{const{status:r,pageSize:a,items:t,hits:s}=e;return r==="loadingquery"||r==="loadingfilter"?o.jsx(O,{count:Math.min(a,s||999)}):t&&t.length?o.jsx("ol",{className:"SearchResults__list",children:t.map((u,d)=>o.jsx(S,{...u},d))}):null},le=(e,r)=>{const{hits:a,items:t,status:s,pageSize:u,loadMore:d}=e;return o.jsx(se,{hits:a,numItems:t&&t.length,status:s,pageSize:u,loadMore:d,texts:r})},j=e=>{const{filters:r,activeFilterIdx:a,setFilter:t,status:s,errorText:u,wrapperProps:d}=e,i=C(e,re),l=P();return o.jsxs("div",{...d,className:z("SearchResults",s!=="results"&&s,(d||{}).className),children:[ie(e,i),o.jsx(te,{domid:l,filters:r,activeIdx:a,setFilter:t,lang:i.lang}),o.jsxs("div",{className:"SearchResults__results",id:l,children:[ne(e),s==="error"&&o.jsx($,{type:"error",children:u||ee()}),le(e,i)]})]})};try{j.displayName="SearchResults",j.__docgenInfo={description:"",displayName:"SearchResults",props:{totalHits:{defaultValue:null,description:"Grand total number of searach results",name:"totalHits",required:!1,type:{name:"number"}},hits:{defaultValue:null,description:"Grand total number of searach results",name:"hits",required:!1,type:{name:"number"}},query:{defaultValue:null,description:"",name:"query",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!1,type:{name:"SearchResultsItemProps[]"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"SearchResultsFilter[]"}},activeFilterIdx:{defaultValue:null,description:"",name:"activeFilterIdx",required:!1,type:{name:"number"}},setFilter:{defaultValue:null,description:"",name:"setFilter",required:!1,type:{name:"((activeTab: number) => void)"}},status:{defaultValue:null,description:"",name:"status",required:!0,type:{name:"enum",value:[{value:'"error"'},{value:'"results"'},{value:'"loadingquery"'},{value:'"loadingfilter"'},{value:'"loadingmore"'}]}},errorText:{defaultValue:null,description:"",name:"errorText",required:!1,type:{name:"ReactNode"}},pageSize:{defaultValue:null,description:"Number of results returned in each page/batch",name:"pageSize",required:!0,type:{name:"number"}},pages:{defaultValue:null,description:"Total number of pages",name:"pages",required:!1,type:{name:"number"}},loadMore:{defaultValue:null,description:"",name:"loadMore",required:!1,type:{name:"(() => void)"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"SearchReesultI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}}}}}catch{}const Ve={title:"SearchResults",parameters:{css:{tokens:"SearchResults,SiteSearchInput"},controls:{hideNoControlsWarning:!0}}},V=A(1,3).map(e=>({title:"Niðurstaða "+e,meta:e%3===1?["Fréttir","15. janúar 2020"]:void 0,summary:"Á leikskólum er haft að leiðarljósi að börnin njóti bernsku sinnar og læri og þroskist í leik og samveru.",href:"/"}));V.unshift({highlight:!0,href:"",title:"Dagforeldrar í Reykjavík",summary:"Á leikskólum er haft að leiðarljósi að börnin njóti bernsku sinnar og læri og þroskist í leik og samveru.",image:Q("borgarstjori1"),meta:"23. janúar 2021"});const x={render:()=>o.jsx(j,{status:"results",pageSize:10,hits:V.length,query:"leitarorð",items:V})};var q,T,F;x.parameters={...x.parameters,docs:{...(q=x.parameters)==null?void 0:q.docs,source:{originalSource:`{
  render: () => <SearchResults status="results" pageSize={10} hits={items.length} query="leitarorð" items={items} />
}`,...(F=(T=x.parameters)==null?void 0:T.docs)==null?void 0:F.source}}};const Ie=["_SearchResults"];export{x as _SearchResults,Ie as __namedExportsOrder,Ve as default};
//# sourceMappingURL=SearchResults.stories-6ed59ffe.js.map
