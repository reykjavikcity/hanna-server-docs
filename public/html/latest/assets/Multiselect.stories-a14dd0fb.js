import{j as a}from"./jsx-runtime-f961835c.js";import{r as p}from"./index-f80c8c95.js";import{m as E}from"./classUtils-ef6e60eb.js";import{u as te,b as re,c as P,n as ne}from"./getScrollbarWidth-70c1e033.js";import"./getSVGtext-8f35f9ab.js";import{g as le}from"./i18n-18e56484.js";import{F as se}from"./_FocusTrap-d2b0137c.js";import{C as oe}from"./Checkbox-84349abe.js";import{F as ie,a as ue}from"./FormField-d640972f.js";import{T as ce}from"./TagPill-dbd3615d.js";import"./_Link-b7c9c4c9.js";import{H as de}from"./HiddenTrigger-d6bdd99f.js";import{f as pe}from"./knobs-764132b4.js";import"./_TogglerInput-01a97f3b.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./_Button-f001a419.js";import"./cssutils-d90b972e.js";import"./assets-ca39b462.js";import"./themes-56ee0168.js";const me=1e4,fe=100,he=1,ge=1/10,be=e=>10/(10+e),A=(e,s)=>{let c=0;return s.forEach(d=>{e.split(/\s+/).forEach((o,n)=>{let u=0;if(o===d)u+=me;else{const v=o.indexOf(d);v===0?u+=fe:v>0&&(u+=he)}c+=u*be(n)})}),c},ye=(e,s)=>{var n;if(!e.value)return 0;const c=e.value.toLowerCase().trim(),d=((n=e.label)==null?void 0:n.toLowerCase().trim())||c;let o=A(d,s);return o||(o=ge*A(c,s)),o},ve="🍌",Se=(e,s,c=ye)=>{if(!s.trim())return e;const d=new Set,o=s.toLowerCase().trim().split(/\s+/);return e.map(n=>({item:n,score:c(n,o,s)})).filter(({score:n})=>n>0).sort((n,u)=>n.score===u.score?0:n.score<u.score?1:-1).map(({item:n})=>n).filter(n=>{const u=n.value+ve+n.label;return d.has(u)?!1:(d.add(u),!0)})},xe=(e,s)=>{const c=Array.isArray(e)?e:[e],d=p.useMemo(()=>c,c);p.useEffect(()=>{const o=n=>{!d.some(v=>{const m=v.current;return m?m.contains(n.target):!1})&&s(n)};return document.addEventListener("mousedown",o),document.addEventListener("touchstart",o),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("touchstart",o)}},[s,d])},U={searchableLimit:20,summaryLimit:20},{searchableLimit:we,summaryLimit:Ve}=U,_e={pl:{search:"Wyszukaj opcje",buttonShow:"Pokaż opcje",currentValues:"Wybrane wartości",noneFoundMsg:"Brak dopasowań"},en:{search:"Search options",buttonShow:"Show options",currentValues:"Currently selected",noneFoundMsg:"No matches"},is:{search:"Leita í valkostum",buttonShow:"Birta valkosti",currentValues:"Valin gildi",noneFoundMsg:"Ekkert passar"}},L=e=>{const{onSelected:s,options:c,disabled:d,readOnly:o}=e,n=d===!0,u=!n&&d,v=te(e.name),[m,N]=re(e,"value",[]),R=m.length>0,K=!R&&!e.placeholder,I=m.length?void 0:e.placeholder,M=le(e,_e),V=p.useRef(null),_=p.useRef(null),[S,q]=p.useState(-1),[j,O]=p.useState(""),[g,$]=p.useState(!1),x=t=>{$(r=>(t=typeof t=="boolean"?t:!r,t||(_.current.querySelector(".Multiselect__choices").scrollTo(0,0),O(""),q(-1)),t))};xe(_,()=>x(!1));const w=p.useMemo(()=>c.map(t=>typeof t=="string"?{value:t}:t),[c]),J=e.forceSearchable||w.length>=we,Q=m.length>0&&(e.forceSummary||!g||w.length>=Ve),b=p.useMemo(()=>Se(w,j,e.searchScoring),[j,w,e.searchScoring]),X=w!==b,k=p.useCallback(t=>{const r=t.value,f=m.indexOf(r)===-1,i=f?[...m,r]:m.filter(l=>l!==r),y=w.filter(l=>i.includes(l.value)).map(l=>l.value);N(y),s&&s({value:t.value,checked:f,option:t,selectedValues:y})},[m,w,s,N]),Y=t=>{const r=t.target.value;O(r===" "?"":r),x(!0)},Z=t=>{j.length===0&&[" ","Delete","Backspace"].includes(t.key)&&x(S>-1?!0:!g)};return p.useEffect(()=>{if(!g)return;const t=r=>{const f=V.current;if(r.key==="ArrowUp")r.preventDefault(),f.focus(),q(i=>i===0?b.length-1:i-1);else if(r.key==="ArrowDown")r.preventDefault(),f.focus(),q(i=>i===b.length-1?0:i+1);else if(r.key==="Escape")r.preventDefault(),f.blur(),f.focus(),x(!1);else if(r.key==="Enter"||r.key===" "){if(r.target.closest(".Multiselect__currentvalues"))return;if(S>=0&&S<b.length){r.preventDefault();const y=b[S];y&&k(y)}}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[S,b,g,k,V]),p.useEffect(()=>{const t=_.current;if(!t)return;let r;const f=()=>clearTimeout(r),i=()=>{r=setTimeout(()=>x(!1),200)};return t.addEventListener("focusin",f),t.addEventListener("focusout",i),()=>{t.removeEventListener("focusin",f),t.removeEventListener("focusout",i)}},[]),p.useEffect(()=>{var t,r;(r=(t=_.current)==null?void 0:t.querySelectorAll(".Multiselect__option")[S])==null||r.scrollIntoView({behavior:"smooth",block:"nearest"})},[S]),a.jsx(ie,{extraClassName:E("Multiselect",e.nowrap&&"nowrap"),group:"inputlike",filled:R,empty:K,...ue(e),renderInput:(t,r,f,i)=>{const{id:y}=r;return a.jsxs("div",{className:E("Multiselect__input",[g&&"open"],t.input),...f(),"data-sprinkled":i,ref:_,children:[i?J?a.jsx("input",{className:"Multiselect__search",id:`toggler:${y}`,"aria-label":M.search,"aria-controls":P(),"data-expanded":g||void 0,onChange:Y,onKeyDown:Z,onClick:()=>x(),value:j,placeholder:I,disabled:n,ref:V}):a.jsx("button",{className:"Multiselect__toggler",id:`toggler:${y}`,type:"button","aria-label":M.buttonShow,"aria-controls":P(),"aria-expanded":g,onClick:()=>x(),disabled:n,ref:V,children:I||" "}):null,a.jsxs("div",{className:"Multiselect__choices",tabIndex:-1,children:[i&&Q&&a.jsx("div",{className:"Multiselect__currentvalues",onClick:g||n?void 0:()=>{var l;x(),(l=V.current)==null||l.focus()},"aria-label":`${M.currentValues}:`,children:m.map(l=>w.find(h=>h.value===l)).filter(ne).map((l,h)=>a.jsx(ce,{large:!0,label:l.label||l.value,...g&&!o?{removable:!0,onRemove:()=>{k(l)}}:{removable:!1}},h))}),a.jsxs("ul",{id:y,className:"Multiselect__options","aria-expanded":i?g:void 0,hidden:i&&!g,role:"group","aria-labelledby":r["aria-labelledby"],"aria-describedby":r["aria-describedby"],"aria-required":e.required,children:[b.length?b.map((l,h)=>{const B=l.disabled!=null?l.disabled:u&&u.includes(h),ee=m.includes(l.value),ae=!X&&l.group!==(b[h-1]||{}).group&&(h>0||!!l.group),D=a.jsx(oe,{className:E("Multiselect__option",S===h&&"focused"),disabled:B,readOnly:o,required:e.required,Wrapper:"li",name:v,...l,checked:ee,"aria-invalid":e.invalid,label:l.label||l.value,onChange:()=>k(l),onFocus:()=>q(h),wrapperProps:{onMouseEnter:()=>q(h)}},h);return ae?a.jsxs(p.Fragment,{children:[a.jsx("li",{className:E("Multiselect__optionSeparator",!l.group&&"empty"),"aria-label":l.group?void 0:"—",children:l.group||!1}),D]},h):D}):j?a.jsx("li",{className:"Multiselect__noresults",children:M.noneFoundMsg}):void 0,i&&a.jsx(se,{Tag:"li"})]})]})]})}})};L.meta=U;try{L.displayName="Multiselect",L.__docgenInfo={description:"",displayName:"Multiselect",props:{className:{defaultValue:null,description:'Container className - alongside "FormField"',name:"className",required:!1,type:{name:"string"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:"SSRSupport"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},LabelTag:{defaultValue:null,description:"",name:"LabelTag",required:!1,type:{name:"enum",value:[{value:'"h3"'},{value:'"h4"'},{value:'"h5"'}]}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[] | TogglerGroupOptions<string, { group?: string | undefined; }>"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean | readonly number[]"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"RestrictedInputProps"}},onSelected:{defaultValue:null,description:"",name:"onSelected",required:!1,type:{name:"((payload: { value: string; checked: boolean; option: TogglerGroupOption<string, { group?: string; }>; selectedValues: string[]; }) => void)"}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:'boolean | "true" | "false"'}},"aria-labelledby":{defaultValue:null,description:"",name:"aria-labelledby",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}},nowrap:{defaultValue:null,description:`Prevent the selected items from wrapping into multiple lines.
Use this option when vertical space is limited.`,name:"nowrap",required:!1,type:{name:"boolean"}},searchScoring:{defaultValue:null,description:`Custom function to calculate a search score for a given option item.
Higher scores mean better matches.

A score of zero (or less) means the item is not a valid match.`,name:"searchScoring",required:!1,type:{name:"SearchScoringfn"}},forceSummary:{defaultValue:null,description:`Force display the current values at the top of the dropdown,
even when the total options are fewer than
\`Multiselect.meta.summaryLimit\`.

NOTE: Using this option is generally not recommended,
because the search UI (i.e. the on-screen keyboard), takes up a lot of
space on mobile devices.`,name:"forceSummary",required:!1,type:{name:"boolean"}},forceSearchable:{defaultValue:null,description:`Force the options to be searchable, even when they're
fewer than \`Multiselect.meta.searchableLimit\`.

NOTE: Using this option is generally not recommended,
because the summary takes up valuable space when there are only a few
items.`,name:"forceSearchable",required:!1,type:{name:"boolean"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"MultiselectI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}}}}}catch{}const F=pe({hideLabel:!1}),Ke={title:"Forms/Multiselect",parameters:{viewport:{defaultViewport:"responsive"}}},T=["Chocolate","Strawberry","Vanilla","Coffee","Mint Chocolate Chip","Rocky Road","Cookies and Cream","Butter Pecan","Pistachio","Maple Walnut","Caramel","Fudge"],z=[{value:"Vanilla",group:"Favourites"},{value:"Pistachio",group:"Favourites"},{value:"Maple Walnut",group:"Favourites"}];z.push(...T.map(e=>({value:e})));const qe=e=>{const{nowrap:s,empty:c,grouped:d,forceSearchable:o,forceSummary:n}=e,u=F.getProps(e),v=c?[]:s?T:T.slice(2,4),m=[s,c,o,n,JSON.stringify(u)].join("-");return a.jsxs(p.Fragment,{children:[a.jsx(L,{nowrap:s,...u,label:"Veldu tegund",name:"flavours",options:d?z:T,value:v,forceSearchable:o,forceSummary:n}),a.jsxs(de,{children:[a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{})]})]},m)},C={render:e=>a.jsx(qe,{...e}),argTypes:{nowrap:{name:"No-wrap"},empty:{name:"Empty"},grouped:{name:"Grouped items"},forceSearchable:{name:"Searchable options"},forceSummary:{name:"Summarize selected values",if:{arg:"empty",truthy:!1}},...F.argTypes},args:{nowrap:!1,empty:!1,grouped:!1,forceSearchable:!1,forceSummary:!1,...F.args}};var W,H,G;C.parameters={...C.parameters,docs:{...(W=C.parameters)==null?void 0:W.docs,source:{originalSource:`{
  render: args => <MultiselectStory {...args} />,
  argTypes: {
    nowrap: {
      name: 'No-wrap'
    },
    empty: {
      name: 'Empty'
    },
    grouped: {
      name: 'Grouped items'
    },
    forceSearchable: {
      name: 'Searchable options'
    },
    forceSummary: {
      name: 'Summarize selected values',
      if: {
        arg: 'empty',
        truthy: false
      }
    },
    ...ffCtrls.argTypes
  },
  args: {
    nowrap: false,
    empty: false,
    grouped: false,
    forceSearchable: false,
    forceSummary: false,
    ...ffCtrls.args
  }
}`,...(G=(H=C.parameters)==null?void 0:H.docs)==null?void 0:G.source}}};const $e=["_Multiselect"];export{C as _Multiselect,$e as __namedExportsOrder,Ke as default};
//# sourceMappingURL=Multiselect.stories-a14dd0fb.js.map
