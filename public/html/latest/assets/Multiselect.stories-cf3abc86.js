import{j as t}from"./jsx-runtime-f961835c.js";import{r as m}from"./index-f80c8c95.js";import{m as M}from"./getSVGtext-6e71cb30.js";import{u as re,a as ne,n as le}from"./_useMobileMenuToggling-b033ca8f.js";import{g as se}from"./i18n-d547729d.js";import{u as oe}from"./useOnClickOutside-2e1471b7.js";import{C as ie}from"./Checkbox-2624b006.js";import{F as ue}from"./FocusTrap-08bc24ce.js";import{F as ce,a as de}from"./FormField-a3e74bd6.js";import{T as pe}from"./TagPill-59a7758d.js";import"./_Link-b7c9c4c9.js";import{H as me}from"./HiddenTiger-e2ccf9ec.js";import{f as fe}from"./knobs-68ae593a.js";import"./_TogglerInput-1e8147c7.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./_Button-2ca4bd3a.js";import"./hannavars-b191aae6.js";import"./ObjectHelpers-f7b28faf.js";import"./assets-a330961d.js";import"./themes-56ee0168.js";const he=1e4,ge=100,be=1,ye=1/10,ve=a=>10/(10+a),W=(a,o)=>{let f=0;return o.forEach(c=>{a.split(/\s+/).forEach((i,h)=>{let n=0;if(i===c)n+=he;else{const d=i.indexOf(c);d===0?n+=ge:d>0&&(n+=be)}f+=n*ve(h)})}),f},Se=(a,o,f,c)=>{if(!a.value)return 0;const i=a.value.toLowerCase().trim(),h=(c==null?void 0:c.toLowerCase().trim())||i;let n=W(h,o);return n||(n=ye*W(i,o)),n},xe="ðŸŒ",we=(a,o,f=Se,c=i=>i.label)=>{if(!o.trim())return a;const i=new Set,h=o.toLowerCase().trim().split(/\s+/);return a.map(n=>({item:n,score:f(n,h,o,c(n))})).filter(({score:n})=>n>0).sort((n,d)=>n.score===d.score?0:n.score<d.score?1:-1).map(({item:n})=>n).filter(n=>{const d=n.value+xe+n.label;return i.has(d)?!1:(i.add(d),!0)})},U={searchableLimit:20,summaryLimit:20},{searchableLimit:Ve,summaryLimit:_e}=U,qe={pl:{search:"Wyszukaj opcje",buttonShow:"PokaÅ¼ opcje",currentValues:"Wybrane wartoÅ›ci",noneFoundMsg:"Brak dopasowaÅ„"},en:{search:"Search options",buttonShow:"Show options",currentValues:"Currently selected",noneFoundMsg:"No matches"},is:{search:"Leita Ã­ valkostum",buttonShow:"Birta valkosti",currentValues:"Valin gildi",noneFoundMsg:"Ekkert passar"}},E=a=>{const{onSelected:o,onDropdown:f,options:c,disabled:i,readOnly:h}=a,n=i===!0,d=!n&&i,F=re(a.name),[y,D]=ne(a,"value",[]),R=y.length>0,K=!R&&!a.placeholder,O=y.length?void 0:a.placeholder,k=se(a,qe),j=m.useRef(null),w=m.useRef(null),[V,_]=m.useState(-1),[q,I]=m.useState(""),[b,$]=m.useState(!1),v=e=>{$(l=>(e=typeof e=="boolean"?e:!l,e||(w.current.querySelector(".Multiselect__choices").scrollTo(0,0),I(""),_(-1)),f&&e!==l&&f(e),e))};oe(w,()=>v(!1));const S=m.useMemo(()=>c.map(e=>typeof e=="string"?{value:e}:e),[c]),J=a.forceSearchable||S.length>=Ve,B=y.length>0&&(a.forceSummary||!b||S.length>=_e),x=m.useMemo(()=>we(S,q,a.searchScoring,a.getSearchContent),[q,S,a.searchScoring,a.getSearchContent]),Q=S!==x,N=m.useCallback(e=>{const l=e.value,g=y.indexOf(l)===-1,s=g?[...y,l]:y.filter(r=>r!==l),p=[...new Set(S.filter(r=>s.includes(r.value)).map(r=>r.value))];D(p),o&&o({value:e.value,checked:g,option:e,selectedValues:p})},[y,S,o,D]),X=e=>{const l=e.target.value;I(l===" "?"":l),v(!0)},Y=e=>{q.length===0&&[" ","Delete","Backspace"].includes(e.key)&&v(V>-1?!0:!b)},Z=e=>{var g;if(!b||!((g=w.current)!=null&&g.contains(e.target)))return;const l=j.current;if(e.key==="ArrowUp")e.preventDefault(),l.focus(),_(s=>s===0?x.length-1:s-1);else if(e.key==="ArrowDown")e.preventDefault(),l.focus(),_(s=>s===x.length-1?0:s+1);else if(e.key==="Escape")e.preventDefault(),l.blur(),l.focus(),v(!1);else if(e.key==="Enter"||e.key===" "){if(e.target.closest(".Multiselect__currentvalues"))return;if(V>=0&&V<x.length){e.preventDefault();const p=x[V];if(p){let r;e.currentTarget.querySelectorAll('input[type="checkbox"]').forEach(u=>{u.value===p.value&&(r=u)}),r.checked=!r.checked,N(p)}}}};return m.useEffect(()=>{const e=w.current;if(!e)return;let l;const g=()=>clearTimeout(l),s=()=>{l=setTimeout(()=>v(!1),200)};return e.addEventListener("focusin",g),e.addEventListener("focusout",s),()=>{e.removeEventListener("focusin",g),e.removeEventListener("focusout",s)}},[]),m.useEffect(()=>{var e,l;(l=(e=w.current)==null?void 0:e.querySelectorAll(".Multiselect__option")[V])==null||l.scrollIntoView({behavior:"smooth",block:"nearest"})},[V]),t.jsx(ce,{extraClassName:M("Multiselect",a.nowrap&&"nowrap"),group:"inputlike",filled:R,empty:K,...de(a),renderInput:(e,l,g,s)=>{const{id:p}=l;return t.jsxs("div",{className:M("Multiselect__input",[b&&"open"],e.input),...g(),"data-sprinkled":s,ref:w,onKeyDown:Z,children:[s?J?t.jsx("input",{className:"Multiselect__search",id:`toggler:${p}`,"aria-label":k.search,"aria-controls":p,"data-expanded":b||void 0,onChange:X,onKeyDown:Y,onClick:()=>v(),value:q,placeholder:O,disabled:n,ref:j}):t.jsx("button",{className:"Multiselect__toggler",id:`toggler:${p}`,type:"button","aria-label":k.buttonShow,"aria-controls":p,"aria-expanded":b,onClick:()=>v(),disabled:n,ref:j,children:O||"Â "}):null,t.jsxs("div",{className:"Multiselect__choices",tabIndex:-1,children:[s&&B&&t.jsx("div",{className:"Multiselect__currentvalues",onClick:b||n?void 0:()=>{var r;v(),(r=j.current)==null||r.focus()},"aria-label":`${k.currentValues}:`,children:y.map(r=>S.find(u=>u.value===r)).filter(le).map((r,u)=>t.jsx(pe,{large:!0,label:r.label||r.value,...b&&!h?{removable:!0,onRemove:()=>{N(r),w.current.querySelector(".Multiselect__choices").focus()}}:{removable:!1}},u))}),t.jsxs("ul",{id:p,className:"Multiselect__options","aria-expanded":s?b:void 0,hidden:s&&!b,role:"group","aria-labelledby":l["aria-labelledby"],"aria-describedby":l["aria-describedby"],"aria-required":a.required,children:[x.length?x.map((r,u)=>{const ee=r.disabled!=null?r.disabled:d&&d.includes(u),ae=y.includes(r.value),te=!Q&&r.group!==(x[u-1]||{}).group&&(u>0||!!r.group),P=t.jsx(ie,{className:M("Multiselect__option",V===u&&"focused"),reqText:!1,disabled:ee,readOnly:h,required:a.required,Wrapper:"li",name:F,...r,checked:ae,"aria-invalid":a.invalid,label:r.label||r.value,onChange:()=>N(r),onFocus:()=>_(u),wrapperProps:{onMouseEnter:()=>_(u)}},u);return te?t.jsxs(m.Fragment,{children:[t.jsx("li",{className:M("Multiselect__optionSeparator",!r.group&&"empty"),"aria-label":r.group?void 0:"â€”",children:r.group||!1}),P]},u):P}):q?t.jsx("li",{className:"Multiselect__noresults",children:k.noneFoundMsg}):void 0,s&&t.jsx(ue,{Tag:"li"})]})]})]})}})};E.meta=U;try{E.displayName="Multiselect",E.__docgenInfo={description:"",displayName:"Multiselect",props:{className:{defaultValue:null,description:'Container className - alongside "FormField"',name:"className",required:!1,type:{name:"string"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:"SSRSupport"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Ãžarf aÃ° fylla Ãºt"\``,name:"reqText",required:!1,type:{name:"string | false"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},LabelTag:{defaultValue:null,description:"",name:"LabelTag",required:!1,type:{name:"enum",value:[{value:'"h3"'},{value:'"h4"'},{value:'"h5"'}]}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[] | TogglerGroupOptions<string, { group?: string | undefined; }>"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean | readonly number[]"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"RestrictedInputProps"}},onSelected:{defaultValue:null,description:"",name:"onSelected",required:!1,type:{name:"((payload: { value: string; checked: boolean; option: TogglerGroupOption<string, { group?: string; }>; selectedValues: string[]; }) => void)"}},renderItemSubContent:{defaultValue:null,description:`Render function that allows inserting content below each toggler
(checkbox/radio) element, depending on the item's checked status
(or other external state)`,name:"renderItemSubContent",required:!1,type:{name:"((option: TogglerGroupOption<string, { group?: string; }>, checked: boolean) => ReactNode)"}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:'boolean | "true" | "false"'}},"aria-labelledby":{defaultValue:null,description:"",name:"aria-labelledby",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}},nowrap:{defaultValue:null,description:`Prevent the selected items from wrapping into multiple lines.
Use this option when vertical space is limited.`,name:"nowrap",required:!1,type:{name:"boolean"}},searchScoring:{defaultValue:null,description:`Custom function to calculate a search score for a given option item.
Higher scores mean better matches.

A score of zero (or less) means the item is not a valid match.`,name:"searchScoring",required:!1,type:{name:"SearchScoringfn"}},getSearchContent:{defaultValue:null,description:"Custom function to extract the searchable content from a given option item.\nBy default, the `label` property is used.",name:"getSearchContent",required:!1,type:{name:"((item: TogglerGroupOption<string, { group?: string; }>) => string)"}},forceSummary:{defaultValue:null,description:`Force display the current values at the top of the dropdown,
even when the total options are fewer than
\`Multiselect.meta.summaryLimit\`.

NOTE: Using this option is generally not recommended,
because the search UI (i.e. the on-screen keyboard), takes up a lot of
space on mobile devices.`,name:"forceSummary",required:!1,type:{name:"boolean"}},forceSearchable:{defaultValue:null,description:`Force the options to be searchable, even when they're
fewer than \`Multiselect.meta.searchableLimit\`.

NOTE: Using this option is generally not recommended,
because the summary takes up valuable space when there are only a few
items.`,name:"forceSearchable",required:!1,type:{name:"boolean"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"MultiselectI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}},onDropdown:{defaultValue:null,description:"Fires whenever the dropdown menu is opened or closed",name:"onDropdown",required:!1,type:{name:"((isOpen: boolean) => void)"}}}}}catch{}const L=fe({hideLabel:!1}),Je={title:"Forms/Multiselect",parameters:{viewport:{defaultViewport:"responsive"}}},T=["Chocolate","Strawberry","Vanilla","Coffee","Mint Chocolate Chip","Rocky Road","Cookies and Cream","Butter Pecan","Pistachio","Maple Walnut","Caramel","Fudge"],z=[{value:"Vanilla",group:"Favourites"},{value:"Pistachio",group:"Favourites"},{value:"Maple Walnut",group:"Favourites"}];z.push(...T.map(a=>({value:a})));const ke=a=>{const{nowrap:o,empty:f,grouped:c,forceSearchable:i,forceSummary:h}=a,n=L.getProps(a),d=f?[]:o?T:T.slice(2,4),F=[o,f,i,h,JSON.stringify(n)].join("-");return t.jsxs(m.Fragment,{children:[t.jsx(E,{nowrap:o,...n,label:"Veldu tegund",name:"flavours",options:c?z:T,value:d,forceSearchable:i,forceSummary:h}),t.jsxs(me,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{})]})]},F)},C={render:a=>t.jsx(ke,{...a}),argTypes:{nowrap:{name:"No-wrap"},empty:{name:"Empty"},grouped:{name:"Grouped items"},forceSearchable:{name:"Searchable options"},forceSummary:{name:"Summarize selected values",if:{arg:"empty",truthy:!1}},...L.argTypes},args:{nowrap:!1,empty:!1,grouped:!1,forceSearchable:!1,forceSummary:!1,...L.args}};var A,G,H;C.parameters={...C.parameters,docs:{...(A=C.parameters)==null?void 0:A.docs,source:{originalSource:`{
  render: args => <MultiselectStory {...args} />,
  argTypes: {
    nowrap: {
      name: 'No-wrap'
    },
    empty: {
      name: 'Empty'
    },
    grouped: {
      name: 'Grouped items'
    },
    forceSearchable: {
      name: 'Searchable options'
    },
    forceSummary: {
      name: 'Summarize selected values',
      if: {
        arg: 'empty',
        truthy: false
      }
    },
    ...ffCtrls.argTypes
  },
  args: {
    nowrap: false,
    empty: false,
    grouped: false,
    forceSearchable: false,
    forceSummary: false,
    ...ffCtrls.args
  }
}`,...(H=(G=C.parameters)==null?void 0:G.docs)==null?void 0:H.source}}};const Be=["_Multiselect"];export{C as _Multiselect,Be as __namedExportsOrder,Je as default};
//# sourceMappingURL=Multiselect.stories-cf3abc86.js.map
