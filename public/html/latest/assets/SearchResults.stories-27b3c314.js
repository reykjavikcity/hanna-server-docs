import{j as n}from"./jsx-runtime-f961835c.js";import{r as M}from"./range-dbab87d5.js";import{r as p}from"./index-f80c8c95.js";import{m as z}from"./getSVGtext-6e71cb30.js";import{g as E}from"./i18n-d547729d.js";import{I as O}from"./_Image-d0ff28fc.js";import{L as $}from"./_Link-b7c9c4c9.js";import{u as C}from"./_useMobileMenuToggling-93fc22f5.js";import{A as H}from"./Alert-8c93eb27.js";import{T as P}from"./Tabs-ce6a995d.js";import{g as U}from"./assets-83022afa.js";import"./useGetSVGtext-67e54c68.js";import"./_Button-a24e90fa.js";import"./env-5a2a565d.js";import"./browserSide-4379edd8.js";import"./getPageScrollElm-bb23cb91.js";var b=new Map,y=new WeakMap,k=0,D=void 0;function Q(e){return e?(y.has(e)||(k+=1,y.set(e,k.toString())),y.get(e)):"0"}function G(e){return Object.keys(e).sort().filter(function(t){return e[t]!==void 0}).map(function(t){return t+"_"+(t==="root"?Q(e.root):e[t])}).toString()}function W(e){var t=G(e),r=b.get(t);if(!r){var i=new Map,a,u=new IntersectionObserver(function(o){o.forEach(function(s){var l,d=s.isIntersecting&&a.some(function(c){return s.intersectionRatio>=c});e.trackVisibility&&typeof s.isVisible>"u"&&(s.isVisible=d),(l=i.get(s.target))==null||l.forEach(function(c){c(d,s)})})},e);a=u.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:u,elements:i},b.set(t,r)}return r}function B(e,t,r,i){if(r===void 0&&(r={}),i===void 0&&(i=D),typeof window.IntersectionObserver>"u"&&i!==void 0){var a=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),function(){}}var u=W(r),o=u.id,s=u.observer,l=u.elements,d=l.get(e)||[];return l.has(e)||l.set(e,d),d.push(t),s.observe(e),function(){d.splice(d.indexOf(t),1),d.length===0&&(l.delete(e),s.unobserve(e)),l.size===0&&(s.disconnect(),b.delete(o))}}function Z(e){var t=e===void 0?{}:e,r=t.threshold,i=t.delay,a=t.trackVisibility,u=t.rootMargin,o=t.root,s=t.triggerOnce,l=t.skip,d=t.initialInView,c=t.fallbackInView,m=p.useRef(),h=p.useState({inView:!!d}),g=h[0],j=h[1],L=p.useCallback(function(V){m.current!==void 0&&(m.current(),m.current=void 0),!l&&V&&(m.current=B(V,function(F,I){j({inView:F,entry:I}),I.isIntersecting&&s&&m.current&&(m.current(),m.current=void 0)},{root:o,rootMargin:u,threshold:r,trackVisibility:a,delay:i},c))},[Array.isArray(r)?r.toString():r,o,u,s,l,a,c,i]);p.useEffect(function(){!m.current&&g.entry&&!s&&!l&&j({inView:!!d})});var f=[L,g.inView,g.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}const _=e=>{const{highlight:t,title:r,summary:i,href:a,meta:u,image:o}=e,s=t?"SearchResultsHighlightItem":"SearchResultsItem",l=Array.isArray(u)?u:[u];return n.jsx("li",{className:s,children:n.jsxs($,{className:`${s}__link`,href:a,children:[n.jsx("h3",{className:`${s}__title`,children:r}),l.length>0&&n.jsx("span",{className:`${s}__meta`,children:l.map((d,c)=>typeof d=="function"?d():d&&n.jsx("span",{children:d},c))}),t&&o&&n.jsx(O,{bem:`${s}__image`,src:o}),n.jsx("div",{className:`${s}__summary`,dangerouslySetInnerHTML:{__html:i}})]})})};try{_.displayName="SearchResultsItem",_.__docgenInfo={description:"",displayName:"SearchResultsItem",props:{title:{defaultValue:null,description:"Plain text title",name:"title",required:!0,type:{name:"string"}},summary:{defaultValue:null,description:"Simple HTML-encoded summary (excluding any layout)",name:"summary",required:!0,type:{name:"string"}},href:{defaultValue:null,description:"",name:"href",required:!0,type:{name:"string"}},meta:{defaultValue:null,description:"",name:"meta",required:!1,type:{name:"MetaValue | readonly MetaValue[]"}},image:{defaultValue:null,description:`URL to the image to display with the result item.
Should ideally be approximately 600-700px wide`,name:"image",required:!1,type:{name:"string"}},highlight:{defaultValue:null,description:'Should this search-result item be displayed as a "major"/"main" result at the top',name:"highlight",required:!1,type:{name:"boolean"}}}}}catch{}const w={},R=(e,t)=>{let r=w[t];return r||(r=w[t]=new Intl.NumberFormat(t)),r.format(e)},J=()=>n.jsxs(n.Fragment,{children:["Úps, það hefur komið upp villa. Má bjóða þér að prófa aftur að leita?",n.jsx("br",{}),"Ef ekkert lát er á villunni þá kunnum við að meta að þú látir okkur vita."]}),K={en:{lang:"en",loadQueryTitle:"Loading results...",resultsTitle:"results found for",noResultsTitle:"No results were found for",loadMore:"Load more"},is:{lang:"is",loadQueryTitle:"Sæki niðurstöður...",resultsTitle:"leitarniðurstöður fyrir",noResultsTitle:"Engar leitarniðurstöður fundust fyrir",loadMore:"Sækja fleiri"},pl:{lang:"pl",loadQueryTitle:"Ładowanie wyników...",resultsTitle:"wyniki wyszukiwania dla",noResultsTitle:"Nie znaleziono wyników dla",loadMore:"Załaduj więcej"}},X=e=>{const{domid:t,filters:r,activeIdx:i,setFilter:a,lang:u}=e,o=p.useMemo(()=>(r||[]).map(({label:s,count:l})=>({label:s,badge:l&&R(l,u)})),[r,u]);return o.length?n.jsx(P,{role:"tablist","aria-controls":t,tabs:o,activeIdx:i||0,onSetActive:s=>a&&a(s)}):null},A=e=>e.count?n.jsx("ol",{className:"SearchResults__list SearchResults__list--loading",children:M(1,e.count).map((t,r)=>n.jsx(_,{title:"...",summary:"",href:""},r))}):null,Y=2,ee=e=>{const{status:t,hits:r,numItems:i,loadMore:a,pageSize:u,texts:o}=e,{lang:s}=o,l=(r||0)-(i||0),d=p.useRef(0),c=!a||d.current>=Y,[m,h]=Z({rootMargin:"150px 0px 0px 0px",skip:c});return p.useEffect(()=>{h&&a&&(d.current=d.current+1,a())},[h,a]),t==="loadingmore"?n.jsx(A,{count:Math.min(u,l)}):t==="results"&&l&&a?n.jsxs("button",{ref:m,className:"SearchResults__loadmore",type:"button",onClick:a,children:[o.loadMore," ",n.jsxs("span",{className:"SearchResults__loadmore__count",children:["(",R(l,s),")"]})]}):null},te=(e,t)=>{const{status:r,totalHits:i,query:a}=e;return n.jsxs("h2",{className:"SearchResults__title",children:[r==="loadingquery"?t.loadQueryTitle:i?`${R(i,t.lang)} ${t.resultsTitle}`:t.noResultsTitle,n.jsx("span",{className:"SearchResults__query",children:a})]})},re=e=>{const{status:t,pageSize:r,items:i,hits:a}=e;return t==="loadingquery"||t==="loadingfilter"?n.jsx(A,{count:Math.min(r,a||999)}):i&&i.length?n.jsx("ol",{className:"SearchResults__list",children:i.map((u,o)=>n.jsx(_,{...u},o))}):null},ae=(e,t)=>{const{hits:r,items:i,status:a,pageSize:u,loadMore:o}=e;return n.jsx(ee,{hits:r,numItems:i&&i.length,status:a,pageSize:u,loadMore:o,texts:t})},x=e=>{const{filters:t,activeFilterIdx:r,setFilter:i,status:a,errorText:u,wrapperProps:o}=e,s=E(e,K),l=C();return n.jsxs("div",{...o,className:z("SearchResults",a!=="results"&&a,(o||{}).className),children:[te(e,s),n.jsx(X,{domid:l,filters:t,activeIdx:r,setFilter:i,lang:s.lang}),n.jsxs("div",{className:"SearchResults__results",id:l,children:[re(e),a==="error"&&n.jsx(H,{type:"error",children:u||J()}),ae(e,s)]})]})};try{x.displayName="SearchResults",x.__docgenInfo={description:"",displayName:"SearchResults",props:{totalHits:{defaultValue:null,description:"Grand total number of searach results",name:"totalHits",required:!1,type:{name:"number"}},hits:{defaultValue:null,description:"Grand total number of searach results",name:"hits",required:!1,type:{name:"number"}},query:{defaultValue:null,description:"",name:"query",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!1,type:{name:"SearchResultsItemProps[]"}},filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"SearchResultsFilter[]"}},activeFilterIdx:{defaultValue:null,description:"",name:"activeFilterIdx",required:!1,type:{name:"number"}},setFilter:{defaultValue:null,description:"",name:"setFilter",required:!1,type:{name:"((activeTab: number) => void)"}},status:{defaultValue:null,description:"",name:"status",required:!0,type:{name:"enum",value:[{value:'"results"'},{value:'"error"'},{value:'"loadingquery"'},{value:'"loadingfilter"'},{value:'"loadingmore"'}]}},errorText:{defaultValue:null,description:"",name:"errorText",required:!1,type:{name:"ReactNode"}},pageSize:{defaultValue:null,description:"Number of results returned in each page/batch",name:"pageSize",required:!0,type:{name:"number"}},pages:{defaultValue:null,description:"Total number of pages",name:"pages",required:!1,type:{name:"number"}},loadMore:{defaultValue:null,description:"",name:"loadMore",required:!1,type:{name:"(() => void)"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"SearchReesultI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"enum",value:[{value:'"is"'},{value:'"en"'},{value:'"pl"'}]}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}}}}}catch{}const be={title:"SearchResults",parameters:{css:{tokens:"SearchResults,SiteSearchInput"},controls:{hideNoControlsWarning:!0}}},S=M(1,3).map(e=>({title:`Niðurstaða ${e}`,meta:e%3===1?["Fréttir","15. janúar 2020"]:void 0,summary:"Á leikskólum er haft að leiðarljósi að börnin njóti bernsku sinnar og læri og þroskist í leik og samveru.",href:"/"}));S.unshift({highlight:!0,href:"",title:"Dagforeldrar í Reykjavík",summary:"Á leikskólum er haft að leiðarljósi að börnin njóti bernsku sinnar og læri og þroskist í leik og samveru.",image:U("borgarstjori1"),meta:"23. janúar 2021"});const v={render:()=>n.jsx(x,{status:"results",pageSize:10,hits:S.length,query:"leitarorð",items:S})};var N,q,T;v.parameters={...v.parameters,docs:{...(N=v.parameters)==null?void 0:N.docs,source:{originalSource:`{
  render: () => <SearchResults status="results" pageSize={10} hits={items.length} query="leitarorð" items={items} />
}`,...(T=(q=v.parameters)==null?void 0:q.docs)==null?void 0:T.source}}};const xe=["_SearchResults"];export{v as _SearchResults,xe as __namedExportsOrder,be as default};
//# sourceMappingURL=SearchResults.stories-27b3c314.js.map
