import{j as a}from"./jsx-runtime-f961835c.js";import{r as p}from"./index-f80c8c95.js";import{m as E}from"./classUtils-ef6e60eb.js";import{a as P}from"./domid-a414b1fb.js";import{h as A}from"./index-603b371f.js";import"./getSVGtext-a5d3ecb0.js";import{a as ee,n as ae}from"./getScrollbarWidth-73ca1995.js";import{g as te}from"./i18n-f5d14da7.js";import{C as ne}from"./Checkbox-0745f68c.js";import{F as re,a as le}from"./FormField-eaf65ac7.js";import{T as se}from"./TagPill-dbd3615d.js";import"./_Link-b7c9c4c9.js";import{H as oe}from"./HiddenTrigger-1a15bc56.js";import{f as ie}from"./knobs-1ca71552.js";import"./hooks-d45327d9.js";import"./addUrlParams-c54217db.js";import"./_TogglerInput-87425c25.js";import"./env-5a2a565d.js";import"./_Button-f001a419.js";import"./cssutils-41198468.js";import"./assets-41f88d07.js";import"./themes-56ee0168.js";const L=e=>{const i=e.Tag||"span";return a.jsx(i,{tabIndex:0,onFocus:c=>{var h;let s=c.currentTarget,r=Math.max(e.depth||0,1);for(;r--&&s;)s=s.parentElement;if(!s)return;const o=s.querySelectorAll("a,input, select, textarea,button, [tabindex]"),m=e.atTop?o.length-1:0;(h=o[m])==null||h.focus()}})};try{L.displayName="FocusTrap",L.__docgenInfo={description:"A focus trap element that can be used to keep keyboard focus within a container block.",displayName:"FocusTrap",props:{Tag:{defaultValue:null,description:"The HTML tag to use for the trap element. (Default `<span />`)",name:"Tag",required:!1,type:{name:"enum",value:[{value:'"span"'},{value:'"li"'}]}},atTop:{defaultValue:null,description:"Set to `true` for focus traps positioned at the top of a container.",name:"atTop",required:!1,type:{name:"boolean"}},depth:{defaultValue:null,description:"How deep the trap is placed in the DOM tree beneath its container element.\n\nDefault: `1`",name:"depth",required:!1,type:{name:"number"}}}}}catch{}const ue=1e4,ce=100,de=1,pe=1/10,me=e=>10/(10+e),H=(e,i)=>{let c=0;return i.forEach(s=>{e.split(/\s+/).forEach((r,o)=>{let m=0;if(r===s)m+=ue;else{const h=r.indexOf(s);h===0?m+=ce:h>0&&(m+=de)}c+=m*me(o)})}),c},fe=(e,i)=>{var o;if(!e.value)return 0;const c=e.value.toLowerCase().trim(),s=((o=e.label)==null?void 0:o.toLowerCase().trim())||c;let r=H(s,i);return r||(r=pe*H(c,i)),r},he=(e,i,c=fe)=>{if(!i.trim())return[...e];const s=i.toLowerCase().trim().split(/\s+/);return e.map(r=>({item:r,score:c(r,s,i)})).filter(({score:r})=>r>0).sort((r,o)=>r.score===o.score?0:r.score<o.score?1:-1).map(({item:r})=>r)},G={searchableLimit:20,summaryLimit:20},{searchableLimit:be,summaryLimit:ye}=G,ge={pl:{search:"Wyszukaj opcje",buttonShow:"Pokaż opcje",currentValues:"Wybrane wartości",noneFoundMsg:"Brak dopasowań"},en:{search:"Search options",buttonShow:"Show options",currentValues:"Currently selected",noneFoundMsg:"No matches"},is:{search:"Leita í valkostum",buttonShow:"Birta valkosti",currentValues:"Valin gildi",noneFoundMsg:"Ekkert passar"}},C=e=>{const{onSelected:i,options:c,disabled:s,readOnly:r}=e,o=s===!0,m=!o&&s,h=A.useDomid(e.name),[b,I]=ee(e,"value",[]),D=b.length>0,K=!D&&!e.placeholder,O=b.length?void 0:e.placeholder,j=te(e,ge),_=p.useRef(null),w=p.useRef(null),[v,q]=p.useState(-1),[T,R]=p.useState(""),[f,$]=p.useState(!1),x=t=>{$(n=>(t=typeof t=="boolean"?t:!n,t||(w.current.querySelector(".Multiselect__choices").scrollTo(0,0),R(""),q(-1)),t))};A.useOnClickOutside(w,()=>x(!1));const S=p.useMemo(()=>c.map(t=>typeof t=="string"?{value:t}:t),[c]),J=e.forceSearchable||S.length>=be,B=b.length>0&&(e.forceSummary||!f||S.length>=ye),V=p.useMemo(()=>he(S,T,e.searchScoring),[T,S,e.searchScoring]),k=p.useCallback(t=>{const n=t.value,d=b.indexOf(n)===-1,u=d?[...b,n]:b.filter(l=>l!==n),y=S.filter(l=>u.includes(l.value)).map(l=>l.value);I(y),i&&i({value:t.value,checked:d,option:t,selectedValues:y})},[b,S,i,I]),Q=t=>{const n=t.target.value;R(n===" "?"":n),x(!0)},X=t=>{T.length===0&&[" ","Delete","Backspace"].includes(t.key)&&x(v>-1?!0:!f)};return p.useEffect(()=>{if(!f)return;const t=n=>{const d=_.current;if(n.key==="ArrowUp")n.preventDefault(),d.focus(),q(u=>u===0?V.length-1:u-1);else if(n.key==="ArrowDown")n.preventDefault(),d.focus(),q(u=>u===V.length-1?0:u+1);else if(n.key==="Escape")n.preventDefault(),d.blur(),d.focus(),x(!1);else if(n.key==="Enter"||n.key===" "){if(n.target.closest(".Multiselect__currentvalues"))return;if(v>=0&&v<V.length){n.preventDefault();const y=V[v];y&&k(y)}}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[v,V,f,k,_]),p.useEffect(()=>{const t=w.current;if(!t)return;let n;const d=()=>clearTimeout(n),u=()=>{n=setTimeout(()=>x(!1),200)};return t.addEventListener("focusin",d),t.addEventListener("focusout",u),()=>{t.removeEventListener("focusin",d),t.removeEventListener("focusout",u)}},[]),p.useEffect(()=>{var t,n;(n=(t=w.current)==null?void 0:t.querySelectorAll(".Multiselect__option")[v])==null||n.scrollIntoView({behavior:"smooth",block:"nearest"})},[v]),a.jsx(re,{extraClassName:E("Multiselect",e.nowrap&&"nowrap"),group:"inputlike",filled:D,empty:K,...le(e),renderInput:(t,n,d,u)=>{const{id:y}=n;return a.jsxs("div",{className:E("Multiselect__input",[f&&"open"],t.input),...d(),"data-sprinkled":u,ref:w,children:[u?J?a.jsx("input",{className:"Multiselect__search",id:`toggler:${y}`,"aria-label":j.search,"aria-controls":P(),"data-expanded":f||void 0,onChange:Q,onKeyDown:X,onClick:()=>x(),value:T,placeholder:O,disabled:o,ref:_}):a.jsx("button",{className:"Multiselect__toggler",id:`toggler:${y}`,type:"button","aria-label":j.buttonShow,"aria-controls":P(),"aria-expanded":f,onClick:()=>x(),disabled:o,ref:_,children:O||" "}):null,a.jsxs("div",{className:"Multiselect__choices",tabIndex:-1,children:[u&&B&&a.jsx("div",{className:"Multiselect__currentvalues",onClick:f||o?void 0:()=>{var l;x(),(l=_.current)==null||l.focus()},"aria-label":`${j.currentValues}:`,children:b.map(l=>S.find(g=>g.value===l)).filter(ae).map((l,g)=>a.jsx(se,{large:!0,label:l.label||l.value,...f&&!r?{removable:!0,onRemove:()=>{k(l)}}:{removable:!1}},g))}),a.jsxs("ul",{id:y,className:"Multiselect__options","aria-expanded":u?f:void 0,hidden:u&&!f,role:"group","aria-labelledby":n["aria-labelledby"],"aria-describedby":n["aria-describedby"],"aria-required":e.required,children:[V.length?V.map((l,g)=>{const Y=l.disabled!=null?l.disabled:m&&m.includes(g),Z=b.includes(l.value);return a.jsx(ne,{className:E("Multiselect__option",v===g&&"focused"),disabled:Y,readOnly:r,required:e.required,Wrapper:"li",name:h,...l,checked:Z,"aria-invalid":e.invalid,label:l.label||l.value,onChange:()=>k(l),onFocus:()=>q(g),wrapperProps:{onMouseEnter:()=>q(g)}},g)}):T?a.jsx("li",{className:"Multiselect__noresults",children:j.noneFoundMsg}):void 0,a.jsx(L,{Tag:"li"})]})]})]})}})};C.meta=G;try{C.displayName="Multiselect",C.__docgenInfo={description:"",displayName:"Multiselect",props:{className:{defaultValue:null,description:'Container className - alongside "FormField"',name:"className",required:!1,type:{name:"string"}},wrapperProps:{defaultValue:null,description:`Custom HTML attributes for the component's wrapper element.

Note, however, that some props may be intentionally
excluded from the list.

__WARNING:__
In some cases props added this way can break the component, og hurt its
accessibility.  Also, some props may get ignored, or over-ridden by the
component. User discretion is advised.`,name:"wrapperProps",required:!1,type:{name:"HTMLProps<null, never>"}},id:{defaultValue:null,description:'Optional pre-determinted id="" for the __input',name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},ssr:{defaultValue:null,description:`Indicates whether server-side rendering is supported or not.

The \`ssr-only\` value is useful for cases where you need
to demo the server-rendered version in a browser.`,name:"ssr",required:!1,type:{name:"SSRSupport"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},assistText:{defaultValue:null,description:"",name:"assistText",required:!1,type:{name:"string | Element"}},hideLabel:{defaultValue:null,description:"",name:"hideLabel",required:!1,type:{name:"boolean"}},invalid:{defaultValue:null,description:"",name:"invalid",required:!1,type:{name:"boolean"}},errorMessage:{defaultValue:null,description:"",name:"errorMessage",required:!1,type:{name:"string | Element"}},reqText:{defaultValue:null,description:`Hidden label prefix text to indicate that the field is required.

If your field is required but should not say so in its label
then set this prop to \`false\`

Default: \`"Þarf að fylla út"\``,name:"reqText",required:!1,type:{name:"string | false"}},wrapperRef:{defaultValue:null,description:"@deprecated Use `*Props.wrapperProps.ref` instead (Will be removed in v0.11)\n\nRef object pointing to the outermost `.FormField` element",name:"wrapperRef",required:!1,type:{name:"RefObject<HTMLElement>"}},LabelTag:{defaultValue:null,description:"",name:"LabelTag",required:!1,type:{name:"enum",value:[{value:'"h3"'},{value:'"h4"'},{value:'"h5"'}]}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[] | TogglerGroupOptions<string>"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean | readonly number[]"}},inputProps:{defaultValue:null,description:"",name:"inputProps",required:!1,type:{name:"RestrictedInputProps"}},onSelected:{defaultValue:null,description:"",name:"onSelected",required:!1,type:{name:"((payload: { value: string; checked: boolean; option: TogglerGroupOption<string>; selectedValues: string[]; }) => void)"}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:'boolean | "true" | "false"'}},"aria-labelledby":{defaultValue:null,description:"",name:"aria-labelledby",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},small:{defaultValue:null,description:"",name:"small",required:!1,type:{name:"boolean"}},nowrap:{defaultValue:null,description:`Prevent the selected items from wrapping into multiple lines.
Use this option when vertical space is limited.`,name:"nowrap",required:!1,type:{name:"boolean"}},searchScoring:{defaultValue:null,description:`Custom function to calculate a search score for a given option item.
Higher scores mean better matches.

A score of zero (or less) means the item is not a valid match.`,name:"searchScoring",required:!1,type:{name:"SearchScoringfn"}},forceSummary:{defaultValue:null,description:`Force display the current values at the top of the dropdown,
even when the total options are fewer than
\`Multiselect.meta.summaryLimit\`.

NOTE: Using this option is generally not recommended,
because the search UI (i.e. the on-screen keyboard), takes up a lot of
space on mobile devices.`,name:"forceSummary",required:!1,type:{name:"boolean"}},forceSearchable:{defaultValue:null,description:`Force the options to be searchable, even when they're
fewer than \`Multiselect.meta.searchableLimit\`.

NOTE: Using this option is generally not recommended,
because the summary takes up valuable space when there are only a few
items.`,name:"forceSearchable",required:!1,type:{name:"boolean"}},texts:{defaultValue:null,description:"",name:"texts",required:!1,type:{name:"MultiselectI18n"}},lang:{defaultValue:null,description:"",name:"lang",required:!1,type:{name:"string"}}}}}catch{}const F=ie({hideLabel:!1}),We={title:"Forms/Multiselect",parameters:{viewport:{defaultViewport:"responsive"}}},N=["Chocolate","Strawberry","Vanilla","Coffee","Mint Chocolate Chip","Rocky Road","Cookies and Cream","Butter Pecan","Pistachio","Maple Walnut","Caramel","Fudge"],ve=e=>{const{nowrap:i,empty:c,forceSearchable:s,forceSummary:r}=e,o=F.getProps(e),m=c?[]:i?N:N.slice(2,4),h=[i,c,s,r,JSON.stringify(o)].join("-");return a.jsxs(p.Fragment,{children:[a.jsx(C,{...o,label:"Veldu tegund",name:"flavours",options:N,value:m,forceSearchable:s,forceSummary:r}),a.jsxs(oe,{children:[a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("br",{})]})]},h)},M={render:e=>a.jsx(ve,{...e}),argTypes:{nowrap:{name:"No-wrap"},empty:{name:"Empty"},forceSearchable:{name:"Searchable options"},forceSummary:{name:"Summarize selected values",if:{arg:"empty",truthy:!1}},...F.argTypes},args:{nowrap:!1,empty:!1,forceSearchable:!1,forceSummary:!1,...F.args}};var W,U,z;M.parameters={...M.parameters,docs:{...(W=M.parameters)==null?void 0:W.docs,source:{originalSource:`{
  render: args => <MultiselectStory {...args} />,
  argTypes: {
    nowrap: {
      name: 'No-wrap'
    },
    empty: {
      name: 'Empty'
    },
    forceSearchable: {
      name: 'Searchable options'
    },
    forceSummary: {
      name: 'Summarize selected values',
      if: {
        arg: 'empty',
        truthy: false
      }
    },
    ...ffCtrls.argTypes
  },
  args: {
    nowrap: false,
    empty: false,
    forceSearchable: false,
    forceSummary: false,
    ...ffCtrls.args
  }
}`,...(z=(U=M.parameters)==null?void 0:U.docs)==null?void 0:z.source}}};const Ue=["_Multiselect"];export{M as _Multiselect,Ue as __namedExportsOrder,We as default};
//# sourceMappingURL=Multiselect.stories-6c56f1d8.js.map
